

    #mandarin size distribution manipulation at picking

    import numpy as np
    import pandas as pd
    import seaborn as sns
    import matplotlib.pyplot as plt

    data=pd.read_csv('mandarin_random_size_dist_at_picking.csv')
    data

         fruit_type fruit_variety  rand_av_size        date     block  doi    sd  \
    0      mandarin          orri         65.88  21/12/2022  lul_2022  355  5.67   
    1      mandarin          orri         67.80  21/12/2022  lul_2022  355  5.67   
    2      mandarin          orri         69.73  21/12/2022  lul_2022  355  5.67   
    3      mandarin          orri         60.76  21/12/2022  lul_2022  355  5.67   
    4      mandarin          orri         64.67  21/12/2022  lul_2022  355  5.67   
    ...         ...           ...           ...         ...       ...  ...   ...   
    3380   mandarin          orri         71.91  09/02/2022  lul_2021   40  5.23   
    3381   mandarin          orri         70.63  09/02/2022  lul_2021   40  5.23   
    3382   mandarin          orri         66.65  09/02/2022  lul_2021   40  5.23   
    3383   mandarin          orri         73.86  09/02/2022  lul_2021   40  5.23   
    3384   mandarin          orri         69.54  09/02/2022  lul_2021   40  5.23   

          av_std  
    0       5.98  
    1       5.98  
    2       5.98  
    3       5.98  
    4       5.98  
    ...      ...  
    3380    5.98  
    3381    5.98  
    3382    5.98  
    3383    5.98  
    3384    5.98  

    [3385 rows x 8 columns]

    #an example for fruit distribution at picking with conventional sd, av size and min/max ranges
    #create normal distribution with known mean at picking, std, and min/max size

    #an example for block with min=49, av=68, max=82 with constant sd of 5.98 at picking time

    mean = 68
    std_dev = 5.98
    min_val = 49
    max_val = 82

    # Create the Gaussian distribution with 3000 samples
    data = np.random.normal(mean, std_dev, 3000)
    # Clip the data to the desired range
    data = np.clip(data, min_val, max_val)
    # Create a pandas DataFrame with the data
    df = pd.DataFrame(data, columns=['Gaussian Data'])

    hist_values, bin_edges = np.histogram(data, bins=20)
    hist_values= hist_values / np.sum(hist_values)
    df = pd.DataFrame({'Histogram Values': hist_values}, index=bin_edges[:-1])

    # Plot the histogram values as a bar plot
    df.plot.bar(y='Histogram Values')
    plt.xlabel('Value Range')
    plt.ylabel('percentage')
    plt.title('Histogram Plot')
    plt.show()

[]

check the min/max diff of random measurements along the season and the coefficient between the dist width early to picking

    data=pd.read_csv('mandarin_growth_all_years.csv')
    data

    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/1890648333.py:1: DtypeWarning: Columns (8,9,11,27,29) have mixed types. Specify dtype option on import or set low_memory=False.
      data=pd.read_csv('mandarin_growth_all_years.csv')

           cultivar variety     block  tree_number  fruit_number fruit_diameter  \
    0      Mandarin    Orri      east          1.0           1.0             23   
    1      Mandarin    Orri      east          1.0           2.0           20.6   
    2      Mandarin    Orri      east          1.0           3.0           17.2   
    3      Mandarin    Orri      east          1.0           4.0           22.9   
    4      Mandarin    Orri      east          1.0           5.0           25.6   
    ...         ...     ...       ...          ...           ...            ...   
    27566  Mandarin    Orri  rendzina          5.0           6.0          55.92   
    27567  Mandarin    Orri  rendzina          5.0           7.0          56.19   
    27568  Mandarin    Orri  rendzina          5.0           8.0            NaN   
    27569  Mandarin    Orri  rendzina          5.0           9.0          66.33   
    27570  Mandarin    Orri  rendzina          5.0          10.0          58.35   

           Av_fruit_diameter date_of_measure relative_mm_increment  \
    0                    NaN      2021-07-26                   NaN   
    1                    NaN      2021-07-26                   NaN   
    2                    NaN      2021-07-26                   NaN   
    3                    NaN      2021-07-26                   NaN   
    4                    NaN      2021-07-26                   NaN   
    ...                  ...             ...                   ...   
    27566                NaN      2022-12-27                   6.2   
    27567                NaN      2022-12-27                  7.56   
    27568                NaN      2022-12-27                   NaN   
    27569                NaN      2022-12-27                  7.54   
    27570                NaN      2022-12-27                  5.92   

          absolute_mm_increment  ...  accumulates_gdd_13 relative_ehu_27_35  \
    0                       NaN  ...                 NaN                NaN   
    1                       NaN  ...                 NaN                NaN   
    2                       NaN  ...                 NaN                NaN   
    3                       NaN  ...                 NaN                NaN   
    4                       NaN  ...                 NaN                NaN   
    ...                     ...  ...                 ...                ...   
    27566                 39.57  ...                 NaN                NaN   
    27567                 37.61  ...                 NaN                NaN   
    27568                   NaN  ...                 NaN                NaN   
    27569                 40.18  ...                 NaN                NaN   
    27570                 33.85  ...                 NaN                NaN   

          monthly_ehu_27_35 relative_precipitation monthly_precipitation  \
    0                   NaN                    NaN                   NaN   
    1                   NaN                    NaN                   NaN   
    2                   NaN                    NaN                   NaN   
    3                   NaN                    NaN                   NaN   
    4                   NaN                    NaN                   NaN   
    ...                 ...                    ...                   ...   
    27566               NaN                    NaN                   NaN   
    27567               NaN                    NaN                   NaN   
    27568               NaN                    NaN                   NaN   
    27569               NaN                    NaN                   NaN   
    27570               NaN                    NaN                   NaN   

          relative_humidity  total_relative_radiation(Mj/m2)  \
    0                   NaN                              NaN   
    1                   NaN                              NaN   
    2                   NaN                              NaN   
    3                   NaN                              NaN   
    4                   NaN                              NaN   
    ...                 ...                              ...   
    27566               NaN                              NaN   
    27567               NaN                              NaN   
    27568               NaN                              NaN   
    27569               NaN                              NaN   
    27570               NaN                              NaN   

           total_radiation_per_month  peel_color  coordinates  
    0                            NaN         NaN          NaN  
    1                            NaN         NaN          NaN  
    2                            NaN         NaN          NaN  
    3                            NaN         NaN          NaN  
    4                            NaN         NaN          NaN  
    ...                          ...         ...          ...  
    27566                        NaN         NaN          NaN  
    27567                        NaN         NaN          NaN  
    27568                        NaN         NaN          NaN  
    27569                        NaN         NaN          NaN  
    27570                        NaN         NaN          NaN  

    [27571 rows x 61 columns]

    # Lul random 2021
    #lul random 2021-2022
    df= data[data['block'].str.contains("lul_random_2021")]
    df

          cultivar variety            block  tree_number  fruit_number  \
    6132  Mandarin    Orri  lul_random_2021          NaN           NaN   
    6133  Mandarin    Orri  lul_random_2021          NaN           NaN   
    6134  Mandarin    Orri  lul_random_2021          NaN           NaN   
    6135  Mandarin    Orri  lul_random_2021          NaN           NaN   
    6136  Mandarin    Orri  lul_random_2021          NaN           NaN   
    ...        ...     ...              ...          ...           ...   
    7719  Mandarin    Orri  lul_random_2021          NaN           NaN   
    7720  Mandarin    Orri  lul_random_2021          NaN           NaN   
    7721  Mandarin    Orri  lul_random_2021          NaN           NaN   
    7722  Mandarin    Orri  lul_random_2021          NaN           NaN   
    7723  Mandarin    Orri  lul_random_2021          NaN           NaN   

         fruit_diameter  Av_fruit_diameter date_of_measure relative_mm_increment  \
    6132          48.68                NaN      2021-08-11                   NaN   
    6133          43.54                NaN      2021-08-11                   NaN   
    6134           37.7                NaN      2021-08-11                   NaN   
    6135          39.54                NaN      2021-08-11                   NaN   
    6136          43.71                NaN      2021-08-11                   NaN   
    ...             ...                ...             ...                   ...   
    7719          71.91                NaN      2022-02-09           -2.11347619   
    7720          70.63                NaN      2022-02-09           -2.11347619   
    7721          66.65                NaN      2022-02-09           -2.11347619   
    7722          73.86                NaN      2022-02-09           -2.11347619   
    7723          69.54                NaN      2022-02-09           -2.11347619   

         absolute_mm_increment  ...  accumulates_gdd_13 relative_ehu_27_35  \
    6132                   NaN  ...                 NaN                NaN   
    6133                   NaN  ...                 NaN                NaN   
    6134                   NaN  ...                 NaN                NaN   
    6135                   NaN  ...                 NaN                NaN   
    6136                   NaN  ...                 NaN                NaN   
    ...                    ...  ...                 ...                ...   
    7719           26.52669146  ...                 NaN                NaN   
    7720           26.52669146  ...                 NaN                NaN   
    7721           26.52669146  ...                 NaN                NaN   
    7722           26.52669146  ...                 NaN                NaN   
    7723           26.52669146  ...                 NaN                NaN   

         monthly_ehu_27_35 relative_precipitation monthly_precipitation  \
    6132               NaN                    NaN                   NaN   
    6133               NaN                    NaN                   NaN   
    6134               NaN                    NaN                   NaN   
    6135               NaN                    NaN                   NaN   
    6136               NaN                    NaN                   NaN   
    ...                ...                    ...                   ...   
    7719               NaN                    NaN                   NaN   
    7720               NaN                    NaN                   NaN   
    7721               NaN                    NaN                   NaN   
    7722               NaN                    NaN                   NaN   
    7723               NaN                    NaN                   NaN   

         relative_humidity  total_relative_radiation(Mj/m2)  \
    6132               NaN                              NaN   
    6133               NaN                              NaN   
    6134               NaN                              NaN   
    6135               NaN                              NaN   
    6136               NaN                              NaN   
    ...                ...                              ...   
    7719               NaN                              NaN   
    7720               NaN                              NaN   
    7721               NaN                              NaN   
    7722               NaN                              NaN   
    7723               NaN                              NaN   

          total_radiation_per_month  peel_color  coordinates  
    6132                        NaN         NaN          NaN  
    6133                        NaN         NaN          NaN  
    6134                        NaN         NaN          NaN  
    6135                        NaN         NaN          NaN  
    6136                        NaN         NaN          NaN  
    ...                         ...         ...          ...  
    7719                        NaN         NaN          NaN  
    7720                        NaN         NaN          NaN  
    7721                        NaN         NaN          NaN  
    7722                        NaN         NaN          NaN  
    7723                        NaN         NaN          NaN  

    [1592 rows x 61 columns]

    df['fruit_diameter']=df['fruit_diameter'].astype(float)

    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/615176181.py:1: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead

    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      df['fruit_diameter']=df['fruit_diameter'].astype(float)

    def min_max_difference(df, date, fruit):
        date_unique= df[date].unique()
        result_df= pd.DataFrame(columns=[date, 'min','max','diff'])
        for val in date_unique:
            filtered_df= df[df[date]== val]
            filtered_fruits = filtered_df[fruit].replace(' ', np.nan).astype(float)
            if len(filtered_fruits) == 0:
                continue
            min_val= np.nanmin(filtered_fruits)
            max_val= np.nanmax(filtered_fruits)
            diff= max_val - min_val
            result_df= result_df.append({date:val, 'min':min_val, 'max':max_val, 'diff':diff}, ignore_index=True)
        return result_df

    res= min_max_difference(df, 'date_of_measure', 'fruit_diameter')
    res
    #dec_aug coefficient of 1.47

    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/1478372578.py:12: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
      result_df= result_df.append({date:val, 'min':min_val, 'max':max_val, 'diff':diff}, ignore_index=True)
    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/1478372578.py:12: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
      result_df= result_df.append({date:val, 'min':min_val, 'max':max_val, 'diff':diff}, ignore_index=True)
    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/1478372578.py:12: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
      result_df= result_df.append({date:val, 'min':min_val, 'max':max_val, 'diff':diff}, ignore_index=True)
    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/1478372578.py:12: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
      result_df= result_df.append({date:val, 'min':min_val, 'max':max_val, 'diff':diff}, ignore_index=True)
    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/1478372578.py:12: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
      result_df= result_df.append({date:val, 'min':min_val, 'max':max_val, 'diff':diff}, ignore_index=True)
    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/1478372578.py:12: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
      result_df= result_df.append({date:val, 'min':min_val, 'max':max_val, 'diff':diff}, ignore_index=True)
    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/1478372578.py:12: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
      result_df= result_df.append({date:val, 'min':min_val, 'max':max_val, 'diff':diff}, ignore_index=True)
    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/1478372578.py:12: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
      result_df= result_df.append({date:val, 'min':min_val, 'max':max_val, 'diff':diff}, ignore_index=True)
    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/1478372578.py:12: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
      result_df= result_df.append({date:val, 'min':min_val, 'max':max_val, 'diff':diff}, ignore_index=True)
    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/1478372578.py:12: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
      result_df= result_df.append({date:val, 'min':min_val, 'max':max_val, 'diff':diff}, ignore_index=True)
    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/1478372578.py:12: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
      result_df= result_df.append({date:val, 'min':min_val, 'max':max_val, 'diff':diff}, ignore_index=True)

       date_of_measure    min    max   diff
    0       2021-08-11  25.73  49.14  23.41
    1       2021-09-02  27.87  51.53  23.66
    2       2021-09-30  31.71  61.19  29.48
    3       2021-10-25  37.34  68.37  31.03
    4       2021-11-09  43.60  75.20  31.60
    5       2021-11-24  46.00  74.66  28.66
    6       2021-12-12  48.83  77.34  28.51
    7       2021-12-28  49.70  84.20  34.50
    8       2022-01-09  51.60  74.38  22.78
    9       2022-01-25  56.10  78.30  22.20
    10      2022-02-09  51.54  76.52  24.98

    sns.lineplot(x='date_of_measure', y='diff', data=res)
    plt.xticks(rotation=90)
    #plt.savefig('min_max diff per date or lul 2021.jpeg', format='jpeg')
    plt.show()

[]

    def normal_dist_per_date(df):
        date_unique= df['date_of_measure'].unique()
        for date in date_unique:
            filtered_df= df[df['date_of_measure']== date]
            mean_val= filtered_df['fruit_diameter'].astype(float).mean()
            std_val= filtered_df['fruit_diameter'].astype(float).std()
            count_val= filtered_df['fruit_diameter'].astype(float).count()
            data = np.random.normal(mean_val, std_val, count_val)
            hist_values, bin_edges = np.histogram(data, bins=20)
            hist_values= hist_values / np.sum(hist_values)
            hist_values= np.round(hist_values,2)
            df_to_plot = pd.DataFrame({'Histogram Values': hist_values}, index=np.round(bin_edges[:-1],2))
            #Plot the histogram values as a bar plot
            df_to_plot.plot.bar(y='Histogram Values')
            plt.xlabel('mm range')
            plt.ylabel('percentage')
            plt.title('Histogram Plot for {}'.format(date))
            #plt.savefig(f'random fruit size dist by date {date}.jpeg', format='jpeg')
            plt.show()

    normal_dist_per_date(df)

[]

[]

[]

[]

[]

[]

[]

[]

[]

[]

[]

lul random 2022

    data=pd.read_csv('mandarin_growth_all_years.csv')
    data

    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/1890648333.py:1: DtypeWarning: Columns (8,9,11,27,29) have mixed types. Specify dtype option on import or set low_memory=False.
      data=pd.read_csv('mandarin_growth_all_years.csv')

           cultivar variety     block  tree_number  fruit_number fruit_diameter  \
    0      Mandarin    Orri      east          1.0           1.0             23   
    1      Mandarin    Orri      east          1.0           2.0           20.6   
    2      Mandarin    Orri      east          1.0           3.0           17.2   
    3      Mandarin    Orri      east          1.0           4.0           22.9   
    4      Mandarin    Orri      east          1.0           5.0           25.6   
    ...         ...     ...       ...          ...           ...            ...   
    27566  Mandarin    Orri  rendzina          5.0           6.0          55.92   
    27567  Mandarin    Orri  rendzina          5.0           7.0          56.19   
    27568  Mandarin    Orri  rendzina          5.0           8.0            NaN   
    27569  Mandarin    Orri  rendzina          5.0           9.0          66.33   
    27570  Mandarin    Orri  rendzina          5.0          10.0          58.35   

           Av_fruit_diameter date_of_measure relative_mm_increment  \
    0                    NaN      2021-07-26                   NaN   
    1                    NaN      2021-07-26                   NaN   
    2                    NaN      2021-07-26                   NaN   
    3                    NaN      2021-07-26                   NaN   
    4                    NaN      2021-07-26                   NaN   
    ...                  ...             ...                   ...   
    27566                NaN      2022-12-27                   6.2   
    27567                NaN      2022-12-27                  7.56   
    27568                NaN      2022-12-27                   NaN   
    27569                NaN      2022-12-27                  7.54   
    27570                NaN      2022-12-27                  5.92   

          absolute_mm_increment  ...  accumulates_gdd_13 relative_ehu_27_35  \
    0                       NaN  ...                 NaN                NaN   
    1                       NaN  ...                 NaN                NaN   
    2                       NaN  ...                 NaN                NaN   
    3                       NaN  ...                 NaN                NaN   
    4                       NaN  ...                 NaN                NaN   
    ...                     ...  ...                 ...                ...   
    27566                 39.57  ...                 NaN                NaN   
    27567                 37.61  ...                 NaN                NaN   
    27568                   NaN  ...                 NaN                NaN   
    27569                 40.18  ...                 NaN                NaN   
    27570                 33.85  ...                 NaN                NaN   

          monthly_ehu_27_35 relative_precipitation monthly_precipitation  \
    0                   NaN                    NaN                   NaN   
    1                   NaN                    NaN                   NaN   
    2                   NaN                    NaN                   NaN   
    3                   NaN                    NaN                   NaN   
    4                   NaN                    NaN                   NaN   
    ...                 ...                    ...                   ...   
    27566               NaN                    NaN                   NaN   
    27567               NaN                    NaN                   NaN   
    27568               NaN                    NaN                   NaN   
    27569               NaN                    NaN                   NaN   
    27570               NaN                    NaN                   NaN   

          relative_humidity  total_relative_radiation(Mj/m2)  \
    0                   NaN                              NaN   
    1                   NaN                              NaN   
    2                   NaN                              NaN   
    3                   NaN                              NaN   
    4                   NaN                              NaN   
    ...                 ...                              ...   
    27566               NaN                              NaN   
    27567               NaN                              NaN   
    27568               NaN                              NaN   
    27569               NaN                              NaN   
    27570               NaN                              NaN   

           total_radiation_per_month  peel_color  coordinates  
    0                            NaN         NaN          NaN  
    1                            NaN         NaN          NaN  
    2                            NaN         NaN          NaN  
    3                            NaN         NaN          NaN  
    4                            NaN         NaN          NaN  
    ...                          ...         ...          ...  
    27566                        NaN         NaN          NaN  
    27567                        NaN         NaN          NaN  
    27568                        NaN         NaN          NaN  
    27569                        NaN         NaN          NaN  
    27570                        NaN         NaN          NaN  

    [27571 rows x 61 columns]

    df= data[data['block'].str.contains("lul_random_2022")]
    df

           cultivar variety            block  tree_number  fruit_number  \
    21357  Mandarin    Orri  lul_random_2022          NaN           NaN   
    21358  Mandarin    Orri  lul_random_2022          NaN           NaN   
    21359  Mandarin    Orri  lul_random_2022          NaN           NaN   
    21360  Mandarin    Orri  lul_random_2022          NaN           NaN   
    21361  Mandarin    Orri  lul_random_2022          NaN           NaN   
    ...         ...     ...              ...          ...           ...   
    22624  Mandarin    Orri  lul_random_2022          NaN           NaN   
    22625  Mandarin    Orri  lul_random_2022          NaN           NaN   
    22626  Mandarin    Orri  lul_random_2022          NaN           NaN   
    22627  Mandarin    Orri  lul_random_2022          NaN           NaN   
    22628  Mandarin    Orri  lul_random_2022          NaN           NaN   

          fruit_diameter  Av_fruit_diameter date_of_measure relative_mm_increment  \
    21357          32.03          31.601008      2022-08-17                   NaN   
    21358          30.53          31.601008      2022-08-17                   NaN   
    21359          34.02          31.601008      2022-08-17                   NaN   
    21360          31.72          31.601008      2022-08-17                   NaN   
    21361          28.92          31.601008      2022-08-17                   NaN   
    ...              ...                ...             ...                   ...   
    22624          60.72          61.768725      2023-01-18                   NaN   
    22625          63.38          61.768725      2023-01-18                   NaN   
    22626          61.64          61.768725      2023-01-18                   NaN   
    22627          56.09          61.768725      2023-01-18                   NaN   
    22628          60.16          61.768725      2023-01-18                   NaN   

          absolute_mm_increment  ...  accumulates_gdd_13 relative_ehu_27_35  \
    21357                   NaN  ...                 NaN                NaN   
    21358                   NaN  ...                 NaN                NaN   
    21359                   NaN  ...                 NaN                NaN   
    21360                   NaN  ...                 NaN                NaN   
    21361                   NaN  ...                 NaN                NaN   
    ...                     ...  ...                 ...                ...   
    22624                   NaN  ...                 NaN                NaN   
    22625                   NaN  ...                 NaN                NaN   
    22626                   NaN  ...                 NaN                NaN   
    22627                   NaN  ...                 NaN                NaN   
    22628                   NaN  ...                 NaN                NaN   

          monthly_ehu_27_35 relative_precipitation monthly_precipitation  \
    21357               NaN                    NaN                   NaN   
    21358               NaN                    NaN                   NaN   
    21359               NaN                    NaN                   NaN   
    21360               NaN                    NaN                   NaN   
    21361               NaN                    NaN                   NaN   
    ...                 ...                    ...                   ...   
    22624               NaN                    NaN                   NaN   
    22625               NaN                    NaN                   NaN   
    22626               NaN                    NaN                   NaN   
    22627               NaN                    NaN                   NaN   
    22628               NaN                    NaN                   NaN   

          relative_humidity  total_relative_radiation(Mj/m2)  \
    21357               NaN                              NaN   
    21358               NaN                              NaN   
    21359               NaN                              NaN   
    21360               NaN                              NaN   
    21361               NaN                              NaN   
    ...                 ...                              ...   
    22624               NaN                              NaN   
    22625               NaN                              NaN   
    22626               NaN                              NaN   
    22627               NaN                              NaN   
    22628               NaN                              NaN   

           total_radiation_per_month  peel_color  coordinates  
    21357                        NaN         NaN          NaN  
    21358                        NaN         NaN          NaN  
    21359                        NaN         NaN          NaN  
    21360                        NaN         NaN          NaN  
    21361                        NaN         NaN          NaN  
    ...                          ...         ...          ...  
    22624                        NaN         NaN          NaN  
    22625                        NaN         NaN          NaN  
    22626                        NaN         NaN          NaN  
    22627                        NaN         NaN          NaN  
    22628                        NaN         NaN          NaN  

    [1272 rows x 61 columns]

    df['fruit_diameter'] = df['fruit_diameter'].replace(' ', np.nan).astype(float)
    df['fruit_diameter']=df['fruit_diameter'].astype(float)

    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/2778908970.py:1: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead

    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      df['fruit_diameter'] = df['fruit_diameter'].replace(' ', np.nan).astype(float)
    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/2778908970.py:2: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead

    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      df['fruit_diameter']=df['fruit_diameter'].astype(float)

    res= min_max_difference(df, 'date_of_measure', 'fruit_diameter')
    res
    #dec_aug coefficient of= 1.66

    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/1478372578.py:12: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
      result_df= result_df.append({date:val, 'min':min_val, 'max':max_val, 'diff':diff}, ignore_index=True)
    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/1478372578.py:12: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
      result_df= result_df.append({date:val, 'min':min_val, 'max':max_val, 'diff':diff}, ignore_index=True)
    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/1478372578.py:12: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
      result_df= result_df.append({date:val, 'min':min_val, 'max':max_val, 'diff':diff}, ignore_index=True)
    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/1478372578.py:12: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
      result_df= result_df.append({date:val, 'min':min_val, 'max':max_val, 'diff':diff}, ignore_index=True)
    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/1478372578.py:12: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
      result_df= result_df.append({date:val, 'min':min_val, 'max':max_val, 'diff':diff}, ignore_index=True)
    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/1478372578.py:12: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
      result_df= result_df.append({date:val, 'min':min_val, 'max':max_val, 'diff':diff}, ignore_index=True)

      date_of_measure    min    max   diff
    0      2022-08-17  21.16  41.06  19.90
    1      2022-09-14  29.70  53.68  23.98
    2      2022-10-06  34.20  59.75  25.55
    3      2022-11-22  39.55  74.20  34.65
    4      2022-12-21  44.58  77.69  33.11
    5      2023-01-18  48.50  80.33  31.83

    sns.lineplot(x='date_of_measure', y='diff', data=res)
    plt.xticks(rotation=90)
    plt.show()

[]

    normal_dist_per_date(df)

[]

[]

[]

[]

[]

[]

or 2011, 2022 season

    data=pd.read_csv('mandarin_growth_all_years.csv')
    data

    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/1890648333.py:1: DtypeWarning: Columns (8,9,11,27,29) have mixed types. Specify dtype option on import or set low_memory=False.
      data=pd.read_csv('mandarin_growth_all_years.csv')

           cultivar variety     block  tree_number  fruit_number fruit_diameter  \
    0      Mandarin    Orri      east          1.0           1.0             23   
    1      Mandarin    Orri      east          1.0           2.0           20.6   
    2      Mandarin    Orri      east          1.0           3.0           17.2   
    3      Mandarin    Orri      east          1.0           4.0           22.9   
    4      Mandarin    Orri      east          1.0           5.0           25.6   
    ...         ...     ...       ...          ...           ...            ...   
    27566  Mandarin    Orri  rendzina          5.0           6.0          55.92   
    27567  Mandarin    Orri  rendzina          5.0           7.0          56.19   
    27568  Mandarin    Orri  rendzina          5.0           8.0            NaN   
    27569  Mandarin    Orri  rendzina          5.0           9.0          66.33   
    27570  Mandarin    Orri  rendzina          5.0          10.0          58.35   

           Av_fruit_diameter date_of_measure relative_mm_increment  \
    0                    NaN      2021-07-26                   NaN   
    1                    NaN      2021-07-26                   NaN   
    2                    NaN      2021-07-26                   NaN   
    3                    NaN      2021-07-26                   NaN   
    4                    NaN      2021-07-26                   NaN   
    ...                  ...             ...                   ...   
    27566                NaN      2022-12-27                   6.2   
    27567                NaN      2022-12-27                  7.56   
    27568                NaN      2022-12-27                   NaN   
    27569                NaN      2022-12-27                  7.54   
    27570                NaN      2022-12-27                  5.92   

          absolute_mm_increment  ...  accumulates_gdd_13 relative_ehu_27_35  \
    0                       NaN  ...                 NaN                NaN   
    1                       NaN  ...                 NaN                NaN   
    2                       NaN  ...                 NaN                NaN   
    3                       NaN  ...                 NaN                NaN   
    4                       NaN  ...                 NaN                NaN   
    ...                     ...  ...                 ...                ...   
    27566                 39.57  ...                 NaN                NaN   
    27567                 37.61  ...                 NaN                NaN   
    27568                   NaN  ...                 NaN                NaN   
    27569                 40.18  ...                 NaN                NaN   
    27570                 33.85  ...                 NaN                NaN   

          monthly_ehu_27_35 relative_precipitation monthly_precipitation  \
    0                   NaN                    NaN                   NaN   
    1                   NaN                    NaN                   NaN   
    2                   NaN                    NaN                   NaN   
    3                   NaN                    NaN                   NaN   
    4                   NaN                    NaN                   NaN   
    ...                 ...                    ...                   ...   
    27566               NaN                    NaN                   NaN   
    27567               NaN                    NaN                   NaN   
    27568               NaN                    NaN                   NaN   
    27569               NaN                    NaN                   NaN   
    27570               NaN                    NaN                   NaN   

          relative_humidity  total_relative_radiation(Mj/m2)  \
    0                   NaN                              NaN   
    1                   NaN                              NaN   
    2                   NaN                              NaN   
    3                   NaN                              NaN   
    4                   NaN                              NaN   
    ...                 ...                              ...   
    27566               NaN                              NaN   
    27567               NaN                              NaN   
    27568               NaN                              NaN   
    27569               NaN                              NaN   
    27570               NaN                              NaN   

           total_radiation_per_month  peel_color  coordinates  
    0                            NaN         NaN          NaN  
    1                            NaN         NaN          NaN  
    2                            NaN         NaN          NaN  
    3                            NaN         NaN          NaN  
    4                            NaN         NaN          NaN  
    ...                          ...         ...          ...  
    27566                        NaN         NaN          NaN  
    27567                        NaN         NaN          NaN  
    27568                        NaN         NaN          NaN  
    27569                        NaN         NaN          NaN  
    27570                        NaN         NaN          NaN  

    [27571 rows x 61 columns]

    df= data[data['block'].str.contains("2011_random_2022")]
    df

           cultivar variety             block  tree_number  fruit_number  \
    22629  Mandarin    Orri  2011_random_2022          NaN           NaN   
    22630  Mandarin    Orri  2011_random_2022          NaN           NaN   
    22631  Mandarin    Orri  2011_random_2022          NaN           NaN   
    22632  Mandarin    Orri  2011_random_2022          NaN           NaN   
    22633  Mandarin    Orri  2011_random_2022          NaN           NaN   
    ...         ...     ...               ...          ...           ...   
    24038  Mandarin    Orri  2011_random_2022          NaN           NaN   
    24039  Mandarin    Orri  2011_random_2022          NaN           NaN   
    24040  Mandarin    Orri  2011_random_2022          NaN           NaN   
    24041  Mandarin    Orri  2011_random_2022          NaN           NaN   
    24042  Mandarin    Orri  2011_random_2022          NaN           NaN   

          fruit_diameter  Av_fruit_diameter date_of_measure relative_mm_increment  \
    22629          33.52          35.719934      2022-08-22                   NaN   
    22630          34.79          35.719934      2022-08-22                   NaN   
    22631           31.6          35.719934      2022-08-22                   NaN   
    22632          36.34          35.719934      2022-08-22                   NaN   
    22633          36.05          35.719934      2022-08-22                   NaN   
    ...              ...                ...             ...                   ...   
    24038          63.46          66.624760      2023-01-18              0.342959   
    24039          59.01          66.624760      2023-01-18              0.342959   
    24040           63.5          66.624760      2023-01-18              0.342959   
    24041          56.42          66.624760      2023-01-18              0.342959   
    24042           67.3          66.624760      2023-01-18              0.342959   

          absolute_mm_increment  ...  accumulates_gdd_13 relative_ehu_27_35  \
    22629                   NaN  ...                 NaN                NaN   
    22630                   NaN  ...                 NaN                NaN   
    22631                   NaN  ...                 NaN                NaN   
    22632                   NaN  ...                 NaN                NaN   
    22633                   NaN  ...                 NaN                NaN   
    ...                     ...  ...                 ...                ...   
    24038             30.904826  ...                 NaN                NaN   
    24039             30.904826  ...                 NaN                NaN   
    24040             30.904826  ...                 NaN                NaN   
    24041             30.904826  ...                 NaN                NaN   
    24042             30.904826  ...                 NaN                NaN   

          monthly_ehu_27_35 relative_precipitation monthly_precipitation  \
    22629               NaN                    NaN                   NaN   
    22630               NaN                    NaN                   NaN   
    22631               NaN                    NaN                   NaN   
    22632               NaN                    NaN                   NaN   
    22633               NaN                    NaN                   NaN   
    ...                 ...                    ...                   ...   
    24038               NaN                    NaN                   NaN   
    24039               NaN                    NaN                   NaN   
    24040               NaN                    NaN                   NaN   
    24041               NaN                    NaN                   NaN   
    24042               NaN                    NaN                   NaN   

          relative_humidity  total_relative_radiation(Mj/m2)  \
    22629               NaN                              NaN   
    22630               NaN                              NaN   
    22631               NaN                              NaN   
    22632               NaN                              NaN   
    22633               NaN                              NaN   
    ...                 ...                              ...   
    24038               NaN                              NaN   
    24039               NaN                              NaN   
    24040               NaN                              NaN   
    24041               NaN                              NaN   
    24042               NaN                              NaN   

           total_radiation_per_month  peel_color  coordinates  
    22629                        NaN         NaN          NaN  
    22630                        NaN         NaN          NaN  
    22631                        NaN         NaN          NaN  
    22632                        NaN         NaN          NaN  
    22633                        NaN         NaN          NaN  
    ...                          ...         ...          ...  
    24038                        NaN         NaN          NaN  
    24039                        NaN         NaN          NaN  
    24040                        NaN         NaN          NaN  
    24041                        NaN         NaN          NaN  
    24042                        NaN         NaN          NaN  

    [1414 rows x 61 columns]

    df['fruit_diameter'] = df['fruit_diameter'].replace(' ', np.nan).astype(float)
    df['fruit_diameter']=df['fruit_diameter'].astype(float)

    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/2778908970.py:1: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead

    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      df['fruit_diameter'] = df['fruit_diameter'].replace(' ', np.nan).astype(float)
    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/2778908970.py:2: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead

    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      df['fruit_diameter']=df['fruit_diameter'].astype(float)

    res= min_max_difference(df, 'date_of_measure', 'fruit_diameter')
    res
    #dec_aug coefficient of 1.18

    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/1478372578.py:12: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
      result_df= result_df.append({date:val, 'min':min_val, 'max':max_val, 'diff':diff}, ignore_index=True)
    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/1478372578.py:12: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
      result_df= result_df.append({date:val, 'min':min_val, 'max':max_val, 'diff':diff}, ignore_index=True)
    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/1478372578.py:12: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
      result_df= result_df.append({date:val, 'min':min_val, 'max':max_val, 'diff':diff}, ignore_index=True)
    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/1478372578.py:12: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
      result_df= result_df.append({date:val, 'min':min_val, 'max':max_val, 'diff':diff}, ignore_index=True)
    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/1478372578.py:12: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
      result_df= result_df.append({date:val, 'min':min_val, 'max':max_val, 'diff':diff}, ignore_index=True)
    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/1478372578.py:12: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
      result_df= result_df.append({date:val, 'min':min_val, 'max':max_val, 'diff':diff}, ignore_index=True)

      date_of_measure    min    max   diff
    0      2022-08-22  23.45  48.17  24.72
    1      2022-09-14  36.04  63.69  27.65
    2      2022-10-11  35.70  64.46  28.76
    3      2022-11-17  47.90  80.51  32.61
    4      2022-12-21  52.64  81.95  29.31
    5      2023-01-18  52.10  82.82  30.72

    sns.lineplot(x='date_of_measure', y='diff', data=res)
    plt.xticks(rotation=90)
    plt.show()

[]

    normal_dist_per_date(df)

[]

[]

[]

[]

[]

[]

or gromosol in zichron yaakov 2022 season

    data=pd.read_csv('mandarin_growth_all_years.csv')
    data

    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/1890648333.py:1: DtypeWarning: Columns (8,9,11,27,29) have mixed types. Specify dtype option on import or set low_memory=False.
      data=pd.read_csv('mandarin_growth_all_years.csv')

           cultivar variety     block  tree_number  fruit_number fruit_diameter  \
    0      Mandarin    Orri      east          1.0           1.0             23   
    1      Mandarin    Orri      east          1.0           2.0           20.6   
    2      Mandarin    Orri      east          1.0           3.0           17.2   
    3      Mandarin    Orri      east          1.0           4.0           22.9   
    4      Mandarin    Orri      east          1.0           5.0           25.6   
    ...         ...     ...       ...          ...           ...            ...   
    27566  Mandarin    Orri  rendzina          5.0           6.0          55.92   
    27567  Mandarin    Orri  rendzina          5.0           7.0          56.19   
    27568  Mandarin    Orri  rendzina          5.0           8.0            NaN   
    27569  Mandarin    Orri  rendzina          5.0           9.0          66.33   
    27570  Mandarin    Orri  rendzina          5.0          10.0          58.35   

           Av_fruit_diameter date_of_measure relative_mm_increment  \
    0                    NaN      2021-07-26                   NaN   
    1                    NaN      2021-07-26                   NaN   
    2                    NaN      2021-07-26                   NaN   
    3                    NaN      2021-07-26                   NaN   
    4                    NaN      2021-07-26                   NaN   
    ...                  ...             ...                   ...   
    27566                NaN      2022-12-27                   6.2   
    27567                NaN      2022-12-27                  7.56   
    27568                NaN      2022-12-27                   NaN   
    27569                NaN      2022-12-27                  7.54   
    27570                NaN      2022-12-27                  5.92   

          absolute_mm_increment  ...  accumulates_gdd_13 relative_ehu_27_35  \
    0                       NaN  ...                 NaN                NaN   
    1                       NaN  ...                 NaN                NaN   
    2                       NaN  ...                 NaN                NaN   
    3                       NaN  ...                 NaN                NaN   
    4                       NaN  ...                 NaN                NaN   
    ...                     ...  ...                 ...                ...   
    27566                 39.57  ...                 NaN                NaN   
    27567                 37.61  ...                 NaN                NaN   
    27568                   NaN  ...                 NaN                NaN   
    27569                 40.18  ...                 NaN                NaN   
    27570                 33.85  ...                 NaN                NaN   

          monthly_ehu_27_35 relative_precipitation monthly_precipitation  \
    0                   NaN                    NaN                   NaN   
    1                   NaN                    NaN                   NaN   
    2                   NaN                    NaN                   NaN   
    3                   NaN                    NaN                   NaN   
    4                   NaN                    NaN                   NaN   
    ...                 ...                    ...                   ...   
    27566               NaN                    NaN                   NaN   
    27567               NaN                    NaN                   NaN   
    27568               NaN                    NaN                   NaN   
    27569               NaN                    NaN                   NaN   
    27570               NaN                    NaN                   NaN   

          relative_humidity  total_relative_radiation(Mj/m2)  \
    0                   NaN                              NaN   
    1                   NaN                              NaN   
    2                   NaN                              NaN   
    3                   NaN                              NaN   
    4                   NaN                              NaN   
    ...                 ...                              ...   
    27566               NaN                              NaN   
    27567               NaN                              NaN   
    27568               NaN                              NaN   
    27569               NaN                              NaN   
    27570               NaN                              NaN   

           total_radiation_per_month  peel_color  coordinates  
    0                            NaN         NaN          NaN  
    1                            NaN         NaN          NaN  
    2                            NaN         NaN          NaN  
    3                            NaN         NaN          NaN  
    4                            NaN         NaN          NaN  
    ...                          ...         ...          ...  
    27566                        NaN         NaN          NaN  
    27567                        NaN         NaN          NaN  
    27568                        NaN         NaN          NaN  
    27569                        NaN         NaN          NaN  
    27570                        NaN         NaN          NaN  

    [27571 rows x 61 columns]

    df= data[data['block'].str.contains("gromosol_random_2022")]
    df
           

           cultivar variety                 block  tree_number  fruit_number  \
    24043  Mandarin    Orri  gromosol_random_2022          NaN           NaN   
    24044  Mandarin    Orri  gromosol_random_2022          NaN           NaN   
    24045  Mandarin    Orri  gromosol_random_2022          NaN           NaN   
    24046  Mandarin    Orri  gromosol_random_2022          NaN           NaN   
    24047  Mandarin    Orri  gromosol_random_2022          NaN           NaN   
    ...         ...     ...                   ...          ...           ...   
    24889  Mandarin    Orri  gromosol_random_2022          NaN           NaN   
    24890  Mandarin    Orri  gromosol_random_2022          NaN           NaN   
    24891  Mandarin    Orri  gromosol_random_2022          NaN           NaN   
    24892  Mandarin    Orri  gromosol_random_2022          NaN           NaN   
    24893  Mandarin    Orri  gromosol_random_2022          NaN           NaN   

          fruit_diameter  Av_fruit_diameter date_of_measure relative_mm_increment  \
    24043          20.92          21.839192      2022-07-22                   NaN   
    24044          19.68          21.839192      2022-07-22                   NaN   
    24045          20.14          21.839192      2022-07-22                   NaN   
    24046           17.6          21.839192      2022-07-22                   NaN   
    24047          13.86          21.839192      2022-07-22                   NaN   
    ...              ...                ...             ...                   ...   
    24889          67.69          63.177904      2022-12-27              8.570455   
    24890          59.39          63.177904      2022-12-27              8.570455   
    24891           63.8          63.177904      2022-12-27              8.570455   
    24892          67.33          63.177904      2022-12-27              8.570455   
    24893          68.67          63.177904      2022-12-27              8.570455   

          absolute_mm_increment  ...  accumulates_gdd_13 relative_ehu_27_35  \
    24043                   NaN  ...                 NaN                NaN   
    24044                   NaN  ...                 NaN                NaN   
    24045                   NaN  ...                 NaN                NaN   
    24046                   NaN  ...                 NaN                NaN   
    24047                   NaN  ...                 NaN                NaN   
    ...                     ...  ...                 ...                ...   
    24889             41.338712  ...                 NaN                NaN   
    24890             41.338712  ...                 NaN                NaN   
    24891             41.338712  ...                 NaN                NaN   
    24892             41.338712  ...                 NaN                NaN   
    24893             41.338712  ...                 NaN                NaN   

          monthly_ehu_27_35 relative_precipitation monthly_precipitation  \
    24043               NaN                    NaN                   NaN   
    24044               NaN                    NaN                   NaN   
    24045               NaN                    NaN                   NaN   
    24046               NaN                    NaN                   NaN   
    24047               NaN                    NaN                   NaN   
    ...                 ...                    ...                   ...   
    24889               NaN                    NaN                   NaN   
    24890               NaN                    NaN                   NaN   
    24891               NaN                    NaN                   NaN   
    24892               NaN                    NaN                   NaN   
    24893               NaN                    NaN                   NaN   

          relative_humidity  total_relative_radiation(Mj/m2)  \
    24043               NaN                              NaN   
    24044               NaN                              NaN   
    24045               NaN                              NaN   
    24046               NaN                              NaN   
    24047               NaN                              NaN   
    ...                 ...                              ...   
    24889               NaN                              NaN   
    24890               NaN                              NaN   
    24891               NaN                              NaN   
    24892               NaN                              NaN   
    24893               NaN                              NaN   

           total_radiation_per_month  peel_color  coordinates  
    24043                        NaN         NaN          NaN  
    24044                        NaN         NaN          NaN  
    24045                        NaN         NaN          NaN  
    24046                        NaN         NaN          NaN  
    24047                        NaN         NaN          NaN  
    ...                          ...         ...          ...  
    24889                        NaN         NaN          NaN  
    24890                        NaN         NaN          NaN  
    24891                        NaN         NaN          NaN  
    24892                        NaN         NaN          NaN  
    24893                        NaN         NaN          NaN  

    [851 rows x 61 columns]

    df['fruit_diameter'] = df['fruit_diameter'].replace(' ', np.nan).astype(float)
    df['fruit_diameter']=df['fruit_diameter'].astype(float)

    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/2778908970.py:1: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead

    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      df['fruit_diameter'] = df['fruit_diameter'].replace(' ', np.nan).astype(float)
    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/2778908970.py:2: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead

    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      df['fruit_diameter']=df['fruit_diameter'].astype(float)

    res= min_max_difference(df, 'date_of_measure', 'fruit_diameter')
    res
    #dec_aug coefficient of 1.18

    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/1478372578.py:12: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
      result_df= result_df.append({date:val, 'min':min_val, 'max':max_val, 'diff':diff}, ignore_index=True)
    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/1478372578.py:12: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
      result_df= result_df.append({date:val, 'min':min_val, 'max':max_val, 'diff':diff}, ignore_index=True)
    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/1478372578.py:12: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
      result_df= result_df.append({date:val, 'min':min_val, 'max':max_val, 'diff':diff}, ignore_index=True)
    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/1478372578.py:12: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
      result_df= result_df.append({date:val, 'min':min_val, 'max':max_val, 'diff':diff}, ignore_index=True)
    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/1478372578.py:12: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
      result_df= result_df.append({date:val, 'min':min_val, 'max':max_val, 'diff':diff}, ignore_index=True)
    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/1478372578.py:12: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
      result_df= result_df.append({date:val, 'min':min_val, 'max':max_val, 'diff':diff}, ignore_index=True)

      date_of_measure    min    max   diff
    0      2022-07-22  13.31  29.15  15.84
    1      2022-08-25  23.98  44.22  20.24
    2      2022-09-13  22.55  50.72  28.17
    3      2022-10-09  34.04  59.26  25.22
    4      2022-11-17  36.52  65.57  29.05
    5      2022-12-27  48.93  79.59  30.66

    sns.lineplot(x='date_of_measure', y='diff', data=res)
    plt.xticks(rotation=90)
    plt.show()

[]

    # rendzina block in zichron yaakov 2022 season

    data=pd.read_csv('mandarin_growth_all_years.csv')
    data

    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/1890648333.py:1: DtypeWarning: Columns (8,9,11,27,29) have mixed types. Specify dtype option on import or set low_memory=False.
      data=pd.read_csv('mandarin_growth_all_years.csv')

           cultivar variety     block  tree_number  fruit_number fruit_diameter  \
    0      Mandarin    Orri      east          1.0           1.0             23   
    1      Mandarin    Orri      east          1.0           2.0           20.6   
    2      Mandarin    Orri      east          1.0           3.0           17.2   
    3      Mandarin    Orri      east          1.0           4.0           22.9   
    4      Mandarin    Orri      east          1.0           5.0           25.6   
    ...         ...     ...       ...          ...           ...            ...   
    27566  Mandarin    Orri  rendzina          5.0           6.0          55.92   
    27567  Mandarin    Orri  rendzina          5.0           7.0          56.19   
    27568  Mandarin    Orri  rendzina          5.0           8.0            NaN   
    27569  Mandarin    Orri  rendzina          5.0           9.0          66.33   
    27570  Mandarin    Orri  rendzina          5.0          10.0          58.35   

           Av_fruit_diameter date_of_measure relative_mm_increment  \
    0                    NaN      2021-07-26                   NaN   
    1                    NaN      2021-07-26                   NaN   
    2                    NaN      2021-07-26                   NaN   
    3                    NaN      2021-07-26                   NaN   
    4                    NaN      2021-07-26                   NaN   
    ...                  ...             ...                   ...   
    27566                NaN      2022-12-27                   6.2   
    27567                NaN      2022-12-27                  7.56   
    27568                NaN      2022-12-27                   NaN   
    27569                NaN      2022-12-27                  7.54   
    27570                NaN      2022-12-27                  5.92   

          absolute_mm_increment  ...  accumulates_gdd_13 relative_ehu_27_35  \
    0                       NaN  ...                 NaN                NaN   
    1                       NaN  ...                 NaN                NaN   
    2                       NaN  ...                 NaN                NaN   
    3                       NaN  ...                 NaN                NaN   
    4                       NaN  ...                 NaN                NaN   
    ...                     ...  ...                 ...                ...   
    27566                 39.57  ...                 NaN                NaN   
    27567                 37.61  ...                 NaN                NaN   
    27568                   NaN  ...                 NaN                NaN   
    27569                 40.18  ...                 NaN                NaN   
    27570                 33.85  ...                 NaN                NaN   

          monthly_ehu_27_35 relative_precipitation monthly_precipitation  \
    0                   NaN                    NaN                   NaN   
    1                   NaN                    NaN                   NaN   
    2                   NaN                    NaN                   NaN   
    3                   NaN                    NaN                   NaN   
    4                   NaN                    NaN                   NaN   
    ...                 ...                    ...                   ...   
    27566               NaN                    NaN                   NaN   
    27567               NaN                    NaN                   NaN   
    27568               NaN                    NaN                   NaN   
    27569               NaN                    NaN                   NaN   
    27570               NaN                    NaN                   NaN   

          relative_humidity  total_relative_radiation(Mj/m2)  \
    0                   NaN                              NaN   
    1                   NaN                              NaN   
    2                   NaN                              NaN   
    3                   NaN                              NaN   
    4                   NaN                              NaN   
    ...                 ...                              ...   
    27566               NaN                              NaN   
    27567               NaN                              NaN   
    27568               NaN                              NaN   
    27569               NaN                              NaN   
    27570               NaN                              NaN   

           total_radiation_per_month  peel_color  coordinates  
    0                            NaN         NaN          NaN  
    1                            NaN         NaN          NaN  
    2                            NaN         NaN          NaN  
    3                            NaN         NaN          NaN  
    4                            NaN         NaN          NaN  
    ...                          ...         ...          ...  
    27566                        NaN         NaN          NaN  
    27567                        NaN         NaN          NaN  
    27568                        NaN         NaN          NaN  
    27569                        NaN         NaN          NaN  
    27570                        NaN         NaN          NaN  

    [27571 rows x 61 columns]

    df= data[data['block'].str.contains("rendzina_random_2022")]
    df

           cultivar variety                 block  tree_number  fruit_number  \
    24894  Mandarin    Orri  rendzina_random_2022          NaN           NaN   
    24895  Mandarin    Orri  rendzina_random_2022          NaN           NaN   
    24896  Mandarin    Orri  rendzina_random_2022          NaN           NaN   
    24897  Mandarin    Orri  rendzina_random_2022          NaN           NaN   
    24898  Mandarin    Orri  rendzina_random_2022          NaN           NaN   
    ...         ...     ...                   ...          ...           ...   
    25781  Mandarin    Orri  rendzina_random_2022          NaN           NaN   
    25782  Mandarin    Orri  rendzina_random_2022          NaN           NaN   
    25783  Mandarin    Orri  rendzina_random_2022          NaN           NaN   
    25784  Mandarin    Orri  rendzina_random_2022          NaN           NaN   
    25785  Mandarin    Orri  rendzina_random_2022          NaN           NaN   

          fruit_diameter  Av_fruit_diameter date_of_measure relative_mm_increment  \
    24894          20.94          21.287426      2022-07-13                   NaN   
    24895          20.54          21.287426      2022-07-13                   NaN   
    24896          23.75          21.287426      2022-07-13                   NaN   
    24897          20.96          21.287426      2022-07-13                   NaN   
    24898          23.32          21.287426      2022-07-13                   NaN   
    ...              ...                ...             ...                   ...   
    25781          63.27          61.965075      2022-12-27              9.278337   
    25782          55.32          61.965075      2022-12-27              9.278337   
    25783          62.11          61.965075      2022-12-27              9.278337   
    25784          68.23          61.965075      2022-12-27              9.278337   
    25785          68.06          61.965075      2022-12-27              9.278337   

          absolute_mm_increment  ...  accumulates_gdd_13 relative_ehu_27_35  \
    24894                   NaN  ...                 NaN                NaN   
    24895                   NaN  ...                 NaN                NaN   
    24896                   NaN  ...                 NaN                NaN   
    24897                   NaN  ...                 NaN                NaN   
    24898                   NaN  ...                 NaN                NaN   
    ...                     ...  ...                 ...                ...   
    25781             40.677649  ...                 NaN                NaN   
    25782             40.677649  ...                 NaN                NaN   
    25783             40.677649  ...                 NaN                NaN   
    25784             40.677649  ...                 NaN                NaN   
    25785             40.677649  ...                 NaN                NaN   

          monthly_ehu_27_35 relative_precipitation monthly_precipitation  \
    24894               NaN                    NaN                   NaN   
    24895               NaN                    NaN                   NaN   
    24896               NaN                    NaN                   NaN   
    24897               NaN                    NaN                   NaN   
    24898               NaN                    NaN                   NaN   
    ...                 ...                    ...                   ...   
    25781               NaN                    NaN                   NaN   
    25782               NaN                    NaN                   NaN   
    25783               NaN                    NaN                   NaN   
    25784               NaN                    NaN                   NaN   
    25785               NaN                    NaN                   NaN   

          relative_humidity  total_relative_radiation(Mj/m2)  \
    24894               NaN                              NaN   
    24895               NaN                              NaN   
    24896               NaN                              NaN   
    24897               NaN                              NaN   
    24898               NaN                              NaN   
    ...                 ...                              ...   
    25781               NaN                              NaN   
    25782               NaN                              NaN   
    25783               NaN                              NaN   
    25784               NaN                              NaN   
    25785               NaN                              NaN   

           total_radiation_per_month  peel_color  coordinates  
    24894                        NaN         NaN          NaN  
    24895                        NaN         NaN          NaN  
    24896                        NaN         NaN          NaN  
    24897                        NaN         NaN          NaN  
    24898                        NaN         NaN          NaN  
    ...                          ...         ...          ...  
    25781                        NaN         NaN          NaN  
    25782                        NaN         NaN          NaN  
    25783                        NaN         NaN          NaN  
    25784                        NaN         NaN          NaN  
    25785                        NaN         NaN          NaN  

    [892 rows x 61 columns]

    df['fruit_diameter'] = df['fruit_diameter'].replace(' ', np.nan).astype(float)
    df['fruit_diameter']=df['fruit_diameter'].astype(float)

    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/2778908970.py:1: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead

    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      df['fruit_diameter'] = df['fruit_diameter'].replace(' ', np.nan).astype(float)
    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/2778908970.py:2: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead

    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      df['fruit_diameter']=df['fruit_diameter'].astype(float)

    res= min_max_difference(df, 'date_of_measure', 'fruit_diameter')
    res
    #dec_aug coefficient of 1

    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/1478372578.py:12: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
      result_df= result_df.append({date:val, 'min':min_val, 'max':max_val, 'diff':diff}, ignore_index=True)
    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/1478372578.py:12: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
      result_df= result_df.append({date:val, 'min':min_val, 'max':max_val, 'diff':diff}, ignore_index=True)
    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/1478372578.py:12: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
      result_df= result_df.append({date:val, 'min':min_val, 'max':max_val, 'diff':diff}, ignore_index=True)
    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/1478372578.py:12: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
      result_df= result_df.append({date:val, 'min':min_val, 'max':max_val, 'diff':diff}, ignore_index=True)
    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/1478372578.py:12: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
      result_df= result_df.append({date:val, 'min':min_val, 'max':max_val, 'diff':diff}, ignore_index=True)
    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/1478372578.py:12: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
      result_df= result_df.append({date:val, 'min':min_val, 'max':max_val, 'diff':diff}, ignore_index=True)
    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_47086/1478372578.py:12: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
      result_df= result_df.append({date:val, 'min':min_val, 'max':max_val, 'diff':diff}, ignore_index=True)

      date_of_measure    min    max   diff
    0      2022-07-13  14.21  28.25  14.04
    1      2022-07-28  16.65  31.17  14.52
    2      2022-08-25  21.03  47.60  26.57
    3      2022-09-13  26.76  48.14  21.38
    4      2022-10-09  33.28  53.84  20.56
    5      2022-11-17  38.84  63.12  24.28
    6      2022-12-27  48.41  76.70  28.29

    sns.lineplot(x='date_of_measure', y='diff', data=res)
    plt.xticks(rotation=90)
    plt.show()

[]

    normal_dist_per_date(df)

[]

[]

[]

[]

[]

[]

[]

distribution using rand size at aug and comparison the distribution with rand size at dec in order to decide what fruit are big/small in other excel file

comapring absolute fruit growth rate from the same fruit/block to decide if big fruit grow in high rate than small fruits

#1st comparison:

#comparing the correlation of the absolut fruit growth rate until dec
with fruit diameter

    data=pd.read_csv('mandarin_growth_all_with_doi.csv')
    data

    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_27820/548808230.py:1: DtypeWarning: Columns (28) have mixed types. Specify dtype option on import or set low_memory=False.
      data=pd.read_csv('mandarin_growth_all_with_doi.csv')

           cultivar variety      block  tree_number  fruit_number  fruit_diameter  \
    0      Mandarin    Orri       east          1.0           1.0           23.00   
    1      Mandarin    Orri       east          1.0           2.0           20.60   
    2      Mandarin    Orri       east          1.0           3.0           17.20   
    3      Mandarin    Orri       east          1.0           4.0           22.90   
    4      Mandarin    Orri       east          1.0           5.0           25.60   
    ...         ...     ...        ...          ...           ...             ...   
    27566  Mandarin    Orri  rendzinaa          5.0           6.0           55.92   
    27567  Mandarin    Orri  rendzinaa          5.0           7.0           56.19   
    27568  Mandarin    Orri  rendzinaa          5.0           8.0             NaN   
    27569  Mandarin    Orri  rendzinaa          5.0           9.0           66.33   
    27570  Mandarin    Orri  rendzinaa          5.0          10.0           58.35   

           Av_fruit_diameter date_of_measure  relative_mm_increment  \
    0                    NaN      26/07/2021                    NaN   
    1                    NaN      26/07/2021                    NaN   
    2                    NaN      26/07/2021                    NaN   
    3                    NaN      26/07/2021                    NaN   
    4                    NaN      26/07/2021                    NaN   
    ...                  ...             ...                    ...   
    27566                NaN      27/12/2022                   6.20   
    27567                NaN      27/12/2022                   7.56   
    27568                NaN      27/12/2022                    NaN   
    27569                NaN      27/12/2022                   7.54   
    27570                NaN      27/12/2022                   5.92   

           absolute_mm_increment  ...  relative_ehu_27_35  monthly_ehu_27_35  \
    0                        NaN  ...                 NaN                NaN   
    1                        NaN  ...                 NaN                NaN   
    2                        NaN  ...                 NaN                NaN   
    3                        NaN  ...                 NaN                NaN   
    4                        NaN  ...                 NaN                NaN   
    ...                      ...  ...                 ...                ...   
    27566                  39.57  ...                 NaN                NaN   
    27567                  37.61  ...                 NaN                NaN   
    27568                    NaN  ...                 NaN                NaN   
    27569                  40.18  ...                 NaN                NaN   
    27570                  33.85  ...                 NaN                NaN   

           relative_precipitation monthly_precipitation relative_humidity  \
    0                         NaN                   NaN               NaN   
    1                         NaN                   NaN               NaN   
    2                         NaN                   NaN               NaN   
    3                         NaN                   NaN               NaN   
    4                         NaN                   NaN               NaN   
    ...                       ...                   ...               ...   
    27566                     NaN                   NaN               NaN   
    27567                     NaN                   NaN               NaN   
    27568                     NaN                   NaN               NaN   
    27569                     NaN                   NaN               NaN   
    27570                     NaN                   NaN               NaN   

          total_relative_radiation(Mj/m2) total_radiation_per_month  peel_color  \
    0                                 NaN                       NaN         NaN   
    1                                 NaN                       NaN         NaN   
    2                                 NaN                       NaN         NaN   
    3                                 NaN                       NaN         NaN   
    4                                 NaN                       NaN         NaN   
    ...                               ...                       ...         ...   
    27566                             NaN                       NaN         NaN   
    27567                             NaN                       NaN         NaN   
    27568                             NaN                       NaN         NaN   
    27569                             NaN                       NaN         NaN   
    27570                             NaN                       NaN         NaN   

           coordinates  date_of_year  
    0              NaN           207  
    1              NaN           207  
    2              NaN           207  
    3              NaN           207  
    4              NaN           207  
    ...            ...           ...  
    27566          NaN           361  
    27567          NaN           361  
    27568          NaN           361  
    27569          NaN           361  
    27570          NaN           361  

    [27571 rows x 63 columns]

    data.info()

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 27571 entries, 0 to 27570
    Data columns (total 63 columns):
     #   Column                           Non-Null Count  Dtype  
    ---  ------                           --------------  -----  
     0   cultivar                         27571 non-null  object 
     1   variety                          27571 non-null  object 
     2   block                            27571 non-null  object 
     3   tree_number                      21367 non-null  float64
     4   fruit_number                     21367 non-null  float64
     5   fruit_diameter                   26522 non-null  float64
     6   Av_fruit_diameter                14464 non-null  float64
     7   date_of_measure                  27571 non-null  object 
     8   relative_mm_increment            23124 non-null  float64
     9   absolute_mm_increment            24146 non-null  float64
     10  days_increment                   26835 non-null  float64
     11  relative_fruit_growth_rate       23094 non-null  float64
     12  absolut_fruit_growth_rate        25083 non-null  float64
     13  rootstock                        23060 non-null  object 
     14  soil_type                        26438 non-null  object 
     15  country                          27571 non-null  object 
     16  location                         27571 non-null  object 
     17  crop_load                        13142 non-null  float64
     18  planting_distance_between_rows   23060 non-null  float64
     19  planting_distance_within_rows    23060 non-null  float64
     20  tree_height                      23060 non-null  float64
     21  tree_length                      14685 non-null  float64
     22  tree_width                       14685 non-null  float64
     23  tree_area                        14685 non-null  float64
     24  normalized_crop_load             3657 non-null   float64
     25  training_system                  15956 non-null  object 
     26  row_direction                    24331 non-null  object 
     27  tree_age                         21163 non-null  float64
     28  fertilization_type               1400 non-null   object 
     29  fertilization_quantity           1400 non-null   float64
     30  irrigation_regime                0 non-null      float64
     31  leaf_area_index                  0 non-null      float64
     32  ndvi                             0 non-null      float64
     33  humidity                         0 non-null      float64
     34  water_potential                  0 non-null      float64
     35  sap_flow                         0 non-null      float64
     36  hormone_application_type         0 non-null      float64
     37  hormone_application_quantity     0 non-null      float64
     38  spray_type                       0 non-null      float64
     39  spray_quantity                   0 non-null      float64
     40  orchard_area                     0 non-null      float64
     41  estimated_date_of_full_bloom     0 non-null      float64
     42  pruning_type                     0 non-null      float64
     43  gridling_number                  0 non-null      float64
     44  relative_heat_sum                0 non-null      float64
     45  heat_sum_units_march_june        0 non-null      float64
     46  heat_sum_units_per_month         0 non-null      float64
     47  total_heat_sum_units             0 non-null      float64
     48  relative_av_temp                 0 non-null      float64
     49  av_monthly_temp                  0 non-null      float64
     50  relative_gdd_13                  0 non-null      float64
     51  monthly_gdd_13_sum               0 non-null      float64
     52  accumulates_gdd_13               0 non-null      float64
     53  relative_ehu_27_35               0 non-null      float64
     54  monthly_ehu_27_35                0 non-null      float64
     55  relative_precipitation           0 non-null      float64
     56  monthly_precipitation            0 non-null      float64
     57  relative_humidity                0 non-null      float64
     58  total_relative_radiation(Mj/m2)  0 non-null      float64
     59  total_radiation_per_month        0 non-null      float64
     60  peel_color                       0 non-null      float64
     61  coordinates                      8925 non-null   object 
     62  date_of_year                     27571 non-null  int64  
    dtypes: float64(50), int64(1), object(12)
    memory usage: 13.3+ MB

    #replace negative value in 'absolut_fruit_growth_rate' column and in 'relative_fruit_growth_rate' column to NAN
    data['absolut_fruit_growth_rate'] = data['absolut_fruit_growth_rate'].where(data['absolut_fruit_growth_rate'] > 0, np.nan)
    data['relative_fruit_growth_rate'] = data['relative_fruit_growth_rate'].where(data['relative_fruit_growth_rate'] > 0, np.nan)
    #fill with NAN the column relative fruit growth rate and absolut_fruit_growth_rate
    data['relative_fruit_growth_rate'] = data['relative_fruit_growth_rate'].fillna(value=np.nan)
    data['absolut_fruit_growth_rate'] = data['absolut_fruit_growth_rate'].fillna(value=np.nan)

    #create another column with month range
    def group_date_of_year(x):
        if x>=182 and x<=211:
            return 'july'
        elif x>=212 and x<=242:
            return 'aug'
        elif x>=243 and x<=273:
            return 'sep' 
        elif x>=274 and x<=304:
            return 'oct'
        elif x>=305 and x<=334:
            return 'nov'
        elif x>=335 and x<=366:
            return 'dec'
        elif x>=1 and x<=30:
            return 'jan'
        elif x>=31 and x<=60:
            return 'feb'
        elif x>=61 and x<=91:
            return 'march'
        elif x>=92 and x<=122:
            return 'april'

    data['date_of_year_group'] = data['date_of_year'].apply(group_date_of_year)
    data

           cultivar variety      block  tree_number  fruit_number  fruit_diameter  \
    0      Mandarin    Orri       east          1.0           1.0           23.00   
    1      Mandarin    Orri       east          1.0           2.0           20.60   
    2      Mandarin    Orri       east          1.0           3.0           17.20   
    3      Mandarin    Orri       east          1.0           4.0           22.90   
    4      Mandarin    Orri       east          1.0           5.0           25.60   
    ...         ...     ...        ...          ...           ...             ...   
    27566  Mandarin    Orri  rendzinaa          5.0           6.0           55.92   
    27567  Mandarin    Orri  rendzinaa          5.0           7.0           56.19   
    27568  Mandarin    Orri  rendzinaa          5.0           8.0             NaN   
    27569  Mandarin    Orri  rendzinaa          5.0           9.0           66.33   
    27570  Mandarin    Orri  rendzinaa          5.0          10.0           58.35   

           Av_fruit_diameter date_of_measure  relative_mm_increment  \
    0                    NaN      26/07/2021                    NaN   
    1                    NaN      26/07/2021                    NaN   
    2                    NaN      26/07/2021                    NaN   
    3                    NaN      26/07/2021                    NaN   
    4                    NaN      26/07/2021                    NaN   
    ...                  ...             ...                    ...   
    27566                NaN      27/12/2022                   6.20   
    27567                NaN      27/12/2022                   7.56   
    27568                NaN      27/12/2022                    NaN   
    27569                NaN      27/12/2022                   7.54   
    27570                NaN      27/12/2022                   5.92   

           absolute_mm_increment  ...  monthly_ehu_27_35  relative_precipitation  \
    0                        NaN  ...                NaN                     NaN   
    1                        NaN  ...                NaN                     NaN   
    2                        NaN  ...                NaN                     NaN   
    3                        NaN  ...                NaN                     NaN   
    4                        NaN  ...                NaN                     NaN   
    ...                      ...  ...                ...                     ...   
    27566                  39.57  ...                NaN                     NaN   
    27567                  37.61  ...                NaN                     NaN   
    27568                    NaN  ...                NaN                     NaN   
    27569                  40.18  ...                NaN                     NaN   
    27570                  33.85  ...                NaN                     NaN   

           monthly_precipitation relative_humidity  \
    0                        NaN               NaN   
    1                        NaN               NaN   
    2                        NaN               NaN   
    3                        NaN               NaN   
    4                        NaN               NaN   
    ...                      ...               ...   
    27566                    NaN               NaN   
    27567                    NaN               NaN   
    27568                    NaN               NaN   
    27569                    NaN               NaN   
    27570                    NaN               NaN   

          total_relative_radiation(Mj/m2) total_radiation_per_month peel_color  \
    0                                 NaN                       NaN        NaN   
    1                                 NaN                       NaN        NaN   
    2                                 NaN                       NaN        NaN   
    3                                 NaN                       NaN        NaN   
    4                                 NaN                       NaN        NaN   
    ...                               ...                       ...        ...   
    27566                             NaN                       NaN        NaN   
    27567                             NaN                       NaN        NaN   
    27568                             NaN                       NaN        NaN   
    27569                             NaN                       NaN        NaN   
    27570                             NaN                       NaN        NaN   

           coordinates  date_of_year  date_of_year_group  
    0              NaN           207                july  
    1              NaN           207                july  
    2              NaN           207                july  
    3              NaN           207                july  
    4              NaN           207                july  
    ...            ...           ...                 ...  
    27566          NaN           361                 dec  
    27567          NaN           361                 dec  
    27568          NaN           361                 dec  
    27569          NaN           361                 dec  
    27570          NaN           361                 dec  

    [27571 rows x 64 columns]

    #or lul all season
    df= data[data['block'].str.contains("lul_2022") | data['block'].str.contains("lul_2020") | data['block'].str.contains("lul_2021") | data['block'].str.contains("or_lul_2022")]
    df

           cultivar variety        block  tree_number  fruit_number  \
    1400   Mandarin    Orri     lul_2022          1.0           1.0   
    1401   Mandarin    Orri     lul_2022          1.0           2.0   
    1402   Mandarin    Orri     lul_2022          1.0           3.0   
    1403   Mandarin    Orri     lul_2022          1.0           4.0   
    1404   Mandarin    Orri     lul_2022          1.0           5.0   
    ...         ...     ...          ...          ...           ...   
    26131  Mandarin    Orri  or_lul_2022          5.0           6.0   
    26132  Mandarin    Orri  or_lul_2022          5.0           7.0   
    26133  Mandarin    Orri  or_lul_2022          5.0           8.0   
    26134  Mandarin    Orri  or_lul_2022          5.0           9.0   
    26135  Mandarin    Orri  or_lul_2022          5.0          10.0   

           fruit_diameter  Av_fruit_diameter date_of_measure  \
    1400             33.8                NaN      26/07/2021   
    1401             33.1                NaN      26/07/2021   
    1402             31.8                NaN      26/07/2021   
    1403             31.3                NaN      26/07/2021   
    1404             33.2                NaN      26/07/2021   
    ...               ...                ...             ...   
    26131             NaN                NaN      18/01/2023   
    26132             NaN                NaN      18/01/2023   
    26133             NaN                NaN      18/01/2023   
    26134             NaN                NaN      18/01/2023   
    26135             NaN                NaN      18/01/2023   

           relative_mm_increment  absolute_mm_increment  ...  monthly_ehu_27_35  \
    1400                     NaN                    NaN  ...                NaN   
    1401                     NaN                    NaN  ...                NaN   
    1402                     NaN                    NaN  ...                NaN   
    1403                     NaN                    NaN  ...                NaN   
    1404                     NaN                    NaN  ...                NaN   
    ...                      ...                    ...  ...                ...   
    26131                    NaN                  36.93  ...                NaN   
    26132                    NaN                  37.00  ...                NaN   
    26133                    NaN                  35.88  ...                NaN   
    26134                    NaN                  41.21  ...                NaN   
    26135                    NaN                  45.42  ...                NaN   

           relative_precipitation  monthly_precipitation relative_humidity  \
    1400                      NaN                    NaN               NaN   
    1401                      NaN                    NaN               NaN   
    1402                      NaN                    NaN               NaN   
    1403                      NaN                    NaN               NaN   
    1404                      NaN                    NaN               NaN   
    ...                       ...                    ...               ...   
    26131                     NaN                    NaN               NaN   
    26132                     NaN                    NaN               NaN   
    26133                     NaN                    NaN               NaN   
    26134                     NaN                    NaN               NaN   
    26135                     NaN                    NaN               NaN   

          total_relative_radiation(Mj/m2) total_radiation_per_month peel_color  \
    1400                              NaN                       NaN        NaN   
    1401                              NaN                       NaN        NaN   
    1402                              NaN                       NaN        NaN   
    1403                              NaN                       NaN        NaN   
    1404                              NaN                       NaN        NaN   
    ...                               ...                       ...        ...   
    26131                             NaN                       NaN        NaN   
    26132                             NaN                       NaN        NaN   
    26133                             NaN                       NaN        NaN   
    26134                             NaN                       NaN        NaN   
    26135                             NaN                       NaN        NaN   

           coordinates  date_of_year  date_of_year_group  
    1400           NaN           207                july  
    1401           NaN           207                july  
    1402           NaN           207                july  
    1403           NaN           207                july  
    1404           NaN           207                july  
    ...            ...           ...                 ...  
    26131          NaN            18                 jan  
    26132          NaN            18                 jan  
    26133          NaN            18                 jan  
    26134          NaN            18                 jan  
    26135          NaN            18                 jan  

    [5675 rows x 64 columns]

    #pearson correlation function to compare the p-value and correlation between fruit diameter at dec and AGR
    from scipy.stats import pearsonr
    import pandas as pd
    def pearson_correlation(df, date_of_year_group, absolut_fruit_growth_rate, fruit_diameter):
        final_df = df[df['date_of_year_group'] == date_of_year_group]
        growth_rate = final_df[absolut_fruit_growth_rate]
        diameter = final_df[fruit_diameter]
        cor_df = pd.DataFrame({'final growth rate': growth_rate, 'final diameter': diameter})
        cor_df = cor_df.dropna()
        correlation, p_value = pearsonr(cor_df['final growth rate'], cor_df['final diameter'])
        return correlation, p_value

    correlation, p_value = pearson_correlation(df, 'dec', 'absolut_fruit_growth_rate', 'fruit_diameter')
    print('The correlation coefficient is:', correlation)
    print('The p-value is:', p_value)
    #good correlation and significant p-value between fruit diameter at the end of the saeson and AGR

    The correlation coefficient is: 0.8086866620643075
    The p-value is: 1.334954194939244e-233

    #or 2011 all season
    df= data[data['block'].str.contains("2011_2021") | data['block'].str.contains("or 2011_2022")]
    df

           cultivar variety         block  tree_number  fruit_number  \
    4550   Mandarin    Orri     2011_2021          1.0           1.0   
    4551   Mandarin    Orri     2011_2021          1.0           2.0   
    4552   Mandarin    Orri     2011_2021          1.0           3.0   
    4553   Mandarin    Orri     2011_2021          1.0           4.0   
    4554   Mandarin    Orri     2011_2021          1.0           5.0   
    ...         ...     ...           ...          ...           ...   
    26481  Mandarin    Orri  or 2011_2022          5.0           6.0   
    26482  Mandarin    Orri  or 2011_2022          5.0           7.0   
    26483  Mandarin    Orri  or 2011_2022          5.0           8.0   
    26484  Mandarin    Orri  or 2011_2022          5.0           9.0   
    26485  Mandarin    Orri  or 2011_2022          5.0          10.0   

           fruit_diameter  Av_fruit_diameter date_of_measure  \
    4550            33.33                NaN      26/07/2021   
    4551            32.53                NaN      26/07/2021   
    4552            27.28                NaN      26/07/2021   
    4553            29.67                NaN      26/07/2021   
    4554            34.14                NaN      26/07/2021   
    ...               ...                ...             ...   
    26481           74.92            75.2075      18/01/2023   
    26482           80.20            75.2075      18/01/2023   
    26483           75.91            75.2075      18/01/2023   
    26484             NaN            75.2075      18/01/2023   
    26485           76.77            75.2075      18/01/2023   

           relative_mm_increment  absolute_mm_increment  ...  monthly_ehu_27_35  \
    4550                     NaN                    NaN  ...                NaN   
    4551                     NaN                    NaN  ...                NaN   
    4552                     NaN                    NaN  ...                NaN   
    4553                     NaN                    NaN  ...                NaN   
    4554                     NaN                    NaN  ...                NaN   
    ...                      ...                    ...  ...                ...   
    26481                   3.42                  27.82  ...                NaN   
    26482                   0.54                  25.97  ...                NaN   
    26483                   1.74                  26.20  ...                NaN   
    26484                    NaN                    NaN  ...                NaN   
    26485                   2.32                  28.38  ...                NaN   

           relative_precipitation  monthly_precipitation relative_humidity  \
    4550                      NaN                    NaN               NaN   
    4551                      NaN                    NaN               NaN   
    4552                      NaN                    NaN               NaN   
    4553                      NaN                    NaN               NaN   
    4554                      NaN                    NaN               NaN   
    ...                       ...                    ...               ...   
    26481                     NaN                    NaN               NaN   
    26482                     NaN                    NaN               NaN   
    26483                     NaN                    NaN               NaN   
    26484                     NaN                    NaN               NaN   
    26485                     NaN                    NaN               NaN   

          total_relative_radiation(Mj/m2) total_radiation_per_month peel_color  \
    4550                              NaN                       NaN        NaN   
    4551                              NaN                       NaN        NaN   
    4552                              NaN                       NaN        NaN   
    4553                              NaN                       NaN        NaN   
    4554                              NaN                       NaN        NaN   
    ...                               ...                       ...        ...   
    26481                             NaN                       NaN        NaN   
    26482                             NaN                       NaN        NaN   
    26483                             NaN                       NaN        NaN   
    26484                             NaN                       NaN        NaN   
    26485                             NaN                       NaN        NaN   

           coordinates  date_of_year  date_of_year_group  
    4550           NaN           207                july  
    4551           NaN           207                july  
    4552           NaN           207                july  
    4553           NaN           207                july  
    4554           NaN           207                july  
    ...            ...           ...                 ...  
    26481          NaN            18                 jan  
    26482          NaN            18                 jan  
    26483          NaN            18                 jan  
    26484          NaN            18                 jan  
    26485          NaN            18                 jan  

    [1932 rows x 64 columns]

    correlation, p_value = pearson_correlation(df, 'dec', 'absolut_fruit_growth_rate', 'fruit_diameter')
    print('The correlation coefficient is:', correlation)
    print('The p-value is:', p_value)

    The correlation coefficient is: 0.171569680295371
    The p-value is: 0.011743758328920453

    #or gromosol

    df= data[data['block'].str.contains("gromosoll")]
    df

           cultivar variety      block  tree_number  fruit_number  fruit_diameter  \
    26486  Mandarin    Orri  gromosoll          1.0           1.0           26.27   
    26487  Mandarin    Orri  gromosoll          1.0           2.0           21.40   
    26488  Mandarin    Orri  gromosoll          1.0           3.0           26.70   
    26489  Mandarin    Orri  gromosoll          1.0           4.0           26.41   
    26490  Mandarin    Orri  gromosoll          1.0           5.0           19.98   
    ...         ...     ...        ...          ...           ...             ...   
    26901  Mandarin    Orri  gromosoll          7.0           6.0           65.70   
    26902  Mandarin    Orri  gromosoll          7.0           7.0           65.02   
    26903  Mandarin    Orri  gromosoll          7.0           8.0           68.10   
    26904  Mandarin    Orri  gromosoll          7.0           9.0           69.00   
    26905  Mandarin    Orri  gromosoll          7.0          10.0           64.37   

           Av_fruit_diameter date_of_measure  relative_mm_increment  \
    26486             21.624      20/07/2022                    NaN   
    26487             21.624      20/07/2022                    NaN   
    26488             21.624      20/07/2022                    NaN   
    26489             21.624      20/07/2022                    NaN   
    26490             21.624      20/07/2022                    NaN   
    ...                  ...             ...                    ...   
    26901             67.693      27/12/2022                   7.66   
    26902             67.693      27/12/2022                   9.64   
    26903             67.693      27/12/2022                   7.86   
    26904             67.693      27/12/2022                   9.40   
    26905             67.693      27/12/2022                   5.78   

           absolute_mm_increment  ...  monthly_ehu_27_35  relative_precipitation  \
    26486                    NaN  ...                NaN                     NaN   
    26487                    NaN  ...                NaN                     NaN   
    26488                    NaN  ...                NaN                     NaN   
    26489                    NaN  ...                NaN                     NaN   
    26490                    NaN  ...                NaN                     NaN   
    ...                      ...  ...                ...                     ...   
    26901                  43.69  ...                NaN                     NaN   
    26902                  44.73  ...                NaN                     NaN   
    26903                  45.98  ...                NaN                     NaN   
    26904                  42.24  ...                NaN                     NaN   
    26905                  41.21  ...                NaN                     NaN   

           monthly_precipitation relative_humidity  \
    26486                    NaN               NaN   
    26487                    NaN               NaN   
    26488                    NaN               NaN   
    26489                    NaN               NaN   
    26490                    NaN               NaN   
    ...                      ...               ...   
    26901                    NaN               NaN   
    26902                    NaN               NaN   
    26903                    NaN               NaN   
    26904                    NaN               NaN   
    26905                    NaN               NaN   

          total_relative_radiation(Mj/m2) total_radiation_per_month peel_color  \
    26486                             NaN                       NaN        NaN   
    26487                             NaN                       NaN        NaN   
    26488                             NaN                       NaN        NaN   
    26489                             NaN                       NaN        NaN   
    26490                             NaN                       NaN        NaN   
    ...                               ...                       ...        ...   
    26901                             NaN                       NaN        NaN   
    26902                             NaN                       NaN        NaN   
    26903                             NaN                       NaN        NaN   
    26904                             NaN                       NaN        NaN   
    26905                             NaN                       NaN        NaN   

           coordinates  date_of_year  date_of_year_group  
    26486          NaN           201                july  
    26487          NaN           201                july  
    26488          NaN           201                july  
    26489          NaN           201                july  
    26490          NaN           201                july  
    ...            ...           ...                 ...  
    26901          NaN           361                 dec  
    26902          NaN           361                 dec  
    26903          NaN           361                 dec  
    26904          NaN           361                 dec  
    26905          NaN           361                 dec  

    [420 rows x 64 columns]

    correlation, p_value = pearson_correlation(df, 'dec', 'absolut_fruit_growth_rate', 'fruit_diameter')
    print('The correlation coefficient is:', correlation)
    print('The p-value is:', p_value)
    #very good correlation and significant p-value between fruit diameter at the end of the saeson and AGR
    #small fruit grow slowly than big fruits

    The correlation coefficient is: 0.9027207411504019
    The p-value is: 1.3139463670273976e-26

    #or rendzina
    df= data[data['block'].str.contains("rendzinaa")]
    df

           cultivar variety      block  tree_number  fruit_number  fruit_diameter  \
    26906  Mandarin    Orri  rendzinaa          1.0           1.0           24.79   
    26907  Mandarin    Orri  rendzinaa          1.0           2.0           21.21   
    26908  Mandarin    Orri  rendzinaa          1.0           3.0           23.30   
    26909  Mandarin    Orri  rendzinaa          1.0           4.0           22.77   
    26910  Mandarin    Orri  rendzinaa          1.0           5.0           16.48   
    ...         ...     ...        ...          ...           ...             ...   
    27566  Mandarin    Orri  rendzinaa          5.0           6.0           55.92   
    27567  Mandarin    Orri  rendzinaa          5.0           7.0           56.19   
    27568  Mandarin    Orri  rendzinaa          5.0           8.0             NaN   
    27569  Mandarin    Orri  rendzinaa          5.0           9.0           66.33   
    27570  Mandarin    Orri  rendzinaa          5.0          10.0           58.35   

           Av_fruit_diameter date_of_measure  relative_mm_increment  \
    26906                NaN      13/07/2022                    NaN   
    26907                NaN      13/07/2022                    NaN   
    26908                NaN      13/07/2022                    NaN   
    26909                NaN      13/07/2022                    NaN   
    26910                NaN      13/07/2022                    NaN   
    ...                  ...             ...                    ...   
    27566                NaN      27/12/2022                   6.20   
    27567                NaN      27/12/2022                   7.56   
    27568                NaN      27/12/2022                    NaN   
    27569                NaN      27/12/2022                   7.54   
    27570                NaN      27/12/2022                   5.92   

           absolute_mm_increment  ...  monthly_ehu_27_35  relative_precipitation  \
    26906                    NaN  ...                NaN                     NaN   
    26907                    NaN  ...                NaN                     NaN   
    26908                    NaN  ...                NaN                     NaN   
    26909                    NaN  ...                NaN                     NaN   
    26910                    NaN  ...                NaN                     NaN   
    ...                      ...  ...                ...                     ...   
    27566                  39.57  ...                NaN                     NaN   
    27567                  37.61  ...                NaN                     NaN   
    27568                    NaN  ...                NaN                     NaN   
    27569                  40.18  ...                NaN                     NaN   
    27570                  33.85  ...                NaN                     NaN   

           monthly_precipitation relative_humidity  \
    26906                    NaN               NaN   
    26907                    NaN               NaN   
    26908                    NaN               NaN   
    26909                    NaN               NaN   
    26910                    NaN               NaN   
    ...                      ...               ...   
    27566                    NaN               NaN   
    27567                    NaN               NaN   
    27568                    NaN               NaN   
    27569                    NaN               NaN   
    27570                    NaN               NaN   

          total_relative_radiation(Mj/m2) total_radiation_per_month peel_color  \
    26906                             NaN                       NaN        NaN   
    26907                             NaN                       NaN        NaN   
    26908                             NaN                       NaN        NaN   
    26909                             NaN                       NaN        NaN   
    26910                             NaN                       NaN        NaN   
    ...                               ...                       ...        ...   
    27566                             NaN                       NaN        NaN   
    27567                             NaN                       NaN        NaN   
    27568                             NaN                       NaN        NaN   
    27569                             NaN                       NaN        NaN   
    27570                             NaN                       NaN        NaN   

           coordinates  date_of_year  date_of_year_group  
    26906          NaN           194                july  
    26907          NaN           194                july  
    26908          NaN           194                july  
    26909          NaN           194                july  
    26910          NaN           194                july  
    ...            ...           ...                 ...  
    27566          NaN           361                 dec  
    27567          NaN           361                 dec  
    27568          NaN           361                 dec  
    27569          NaN           361                 dec  
    27570          NaN           361                 dec  

    [665 rows x 64 columns]

    correlation, p_value = pearson_correlation(df, 'dec', 'absolut_fruit_growth_rate', 'fruit_diameter')
    print('The correlation coefficient is:', correlation)
    print('The p-value is:', p_value)
    #good correlation and significant p-value

    The correlation coefficient is: 0.7363512545970126
    The p-value is: 6.533035101162182e-16

    #orri de wagendrift
    df= data[data['block'].str.contains("30")]
    df

           cultivar variety block  tree_number  fruit_number  fruit_diameter  \
    19482  Mandarin    Orri    30          1.0           1.0           32.23   
    19483  Mandarin    Orri    30          1.0           2.0           27.83   
    19484  Mandarin    Orri    30          1.0           3.0           25.86   
    19485  Mandarin    Orri    30          1.0           4.0           30.00   
    19486  Mandarin    Orri    30          1.0           5.0           28.30   
    ...         ...     ...   ...          ...           ...             ...   
    21352  Mandarin    Orri    30          5.0          21.0           74.13   
    21353  Mandarin    Orri    30          5.0          22.0           82.07   
    21354  Mandarin    Orri    30          5.0          23.0           73.20   
    21355  Mandarin    Orri    30          5.0          24.0           67.63   
    21356  Mandarin    Orri    30          5.0          25.0           70.04   

           Av_fruit_diameter date_of_measure  relative_mm_increment  \
    19482            29.4176      07/01/2022                    NaN   
    19483            29.4176      07/01/2022                    NaN   
    19484            29.4176      07/01/2022                    NaN   
    19485            29.4176      07/01/2022                    NaN   
    19486            29.4176      07/01/2022                    NaN   
    ...                  ...             ...                    ...   
    21352            70.1284      17/07/2022                   0.25   
    21353            70.1284      17/07/2022                   0.09   
    21354            70.1284      17/07/2022                   0.89   
    21355            70.1284      17/07/2022                   0.14   
    21356            70.1284      17/07/2022                   0.24   

           absolute_mm_increment  ...  monthly_ehu_27_35  relative_precipitation  \
    19482                    NaN  ...                NaN                     NaN   
    19483                    NaN  ...                NaN                     NaN   
    19484                    NaN  ...                NaN                     NaN   
    19485                    NaN  ...                NaN                     NaN   
    19486                    NaN  ...                NaN                     NaN   
    ...                      ...  ...                ...                     ...   
    21352                  35.03  ...                NaN                     NaN   
    21353                  40.17  ...                NaN                     NaN   
    21354                  38.11  ...                NaN                     NaN   
    21355                  35.39  ...                NaN                     NaN   
    21356                  34.89  ...                NaN                     NaN   

           monthly_precipitation relative_humidity  \
    19482                    NaN               NaN   
    19483                    NaN               NaN   
    19484                    NaN               NaN   
    19485                    NaN               NaN   
    19486                    NaN               NaN   
    ...                      ...               ...   
    21352                    NaN               NaN   
    21353                    NaN               NaN   
    21354                    NaN               NaN   
    21355                    NaN               NaN   
    21356                    NaN               NaN   

          total_relative_radiation(Mj/m2) total_radiation_per_month peel_color  \
    19482                             NaN                       NaN        NaN   
    19483                             NaN                       NaN        NaN   
    19484                             NaN                       NaN        NaN   
    19485                             NaN                       NaN        NaN   
    19486                             NaN                       NaN        NaN   
    ...                               ...                       ...        ...   
    21352                             NaN                       NaN        NaN   
    21353                             NaN                       NaN        NaN   
    21354                             NaN                       NaN        NaN   
    21355                             NaN                       NaN        NaN   
    21356                             NaN                       NaN        NaN   

               coordinates  date_of_year  date_of_year_group  
    19482  25.388S,29.394E           190                july  
    19483  25.388S,29.394E           190                july  
    19484  25.388S,29.394E           190                july  
    19485  25.388S,29.394E           190                july  
    19486  25.388S,29.394E           190                july  
    ...                ...           ...                 ...  
    21352  25.388S,29.394E            16                 jan  
    21353  25.388S,29.394E            16                 jan  
    21354  25.388S,29.394E            16                 jan  
    21355  25.388S,29.394E            16                 jan  
    21356  25.388S,29.394E            16                 jan  

    [1875 rows x 64 columns]

    correlation, p_value = pearson_correlation(df, 'dec', 'absolut_fruit_growth_rate', 'fruit_diameter')
    print('The correlation coefficient is:', correlation)
    print('The p-value is:', p_value)

    The correlation coefficient is: 0.6848024757618767
    The p-value is: 6.068864290607039e-36

    #or east
    df= data[data['block'].str.contains("east")]
    df

          cultivar variety block  tree_number  fruit_number  fruit_diameter  \
    0     Mandarin    Orri  east          1.0           1.0           23.00   
    1     Mandarin    Orri  east          1.0           2.0           20.60   
    2     Mandarin    Orri  east          1.0           3.0           17.20   
    3     Mandarin    Orri  east          1.0           4.0           22.90   
    4     Mandarin    Orri  east          1.0           5.0           25.60   
    ...        ...     ...   ...          ...           ...             ...   
    1395  Mandarin    Orri  east          4.0          21.0           53.49   
    1396  Mandarin    Orri  east          4.0          22.0           63.76   
    1397  Mandarin    Orri  east          4.0          23.0           48.12   
    1398  Mandarin    Orri  east          4.0          24.0             NaN   
    1399  Mandarin    Orri  east          4.0          25.0           50.25   

          Av_fruit_diameter date_of_measure  relative_mm_increment  \
    0                   NaN      26/07/2021                    NaN   
    1                   NaN      26/07/2021                    NaN   
    2                   NaN      26/07/2021                    NaN   
    3                   NaN      26/07/2021                    NaN   
    4                   NaN      26/07/2021                    NaN   
    ...                 ...             ...                    ...   
    1395                NaN      23/02/2022                   0.59   
    1396                NaN      23/02/2022                   0.38   
    1397                NaN      23/02/2022                    NaN   
    1398                NaN      23/02/2022                    NaN   
    1399                NaN      23/02/2022                   1.13   

          absolute_mm_increment  ...  monthly_ehu_27_35  relative_precipitation  \
    0                       NaN  ...                NaN                     NaN   
    1                       NaN  ...                NaN                     NaN   
    2                       NaN  ...                NaN                     NaN   
    3                       NaN  ...                NaN                     NaN   
    4                       NaN  ...                NaN                     NaN   
    ...                     ...  ...                ...                     ...   
    1395                  23.13  ...                NaN                     NaN   
    1396                  44.49  ...                NaN                     NaN   
    1397                  26.02  ...                NaN                     NaN   
    1398                    NaN  ...                NaN                     NaN   
    1399                  50.25  ...                NaN                     NaN   

          monthly_precipitation relative_humidity total_relative_radiation(Mj/m2)  \
    0                       NaN               NaN                             NaN   
    1                       NaN               NaN                             NaN   
    2                       NaN               NaN                             NaN   
    3                       NaN               NaN                             NaN   
    4                       NaN               NaN                             NaN   
    ...                     ...               ...                             ...   
    1395                    NaN               NaN                             NaN   
    1396                    NaN               NaN                             NaN   
    1397                    NaN               NaN                             NaN   
    1398                    NaN               NaN                             NaN   
    1399                    NaN               NaN                             NaN   

         total_radiation_per_month peel_color  coordinates  date_of_year  \
    0                          NaN        NaN          NaN           207   
    1                          NaN        NaN          NaN           207   
    2                          NaN        NaN          NaN           207   
    3                          NaN        NaN          NaN           207   
    4                          NaN        NaN          NaN           207   
    ...                        ...        ...          ...           ...   
    1395                       NaN        NaN          NaN            54   
    1396                       NaN        NaN          NaN            54   
    1397                       NaN        NaN          NaN            54   
    1398                       NaN        NaN          NaN            54   
    1399                       NaN        NaN          NaN            54   

          date_of_year_group  
    0                   july  
    1                   july  
    2                   july  
    3                   july  
    4                   july  
    ...                  ...  
    1395                 feb  
    1396                 feb  
    1397                 feb  
    1398                 feb  
    1399                 feb  

    [1400 rows x 64 columns]

    correlation, p_value = pearson_correlation(df, 'dec', 'absolut_fruit_growth_rate', 'fruit_diameter')
    print('The correlation coefficient is:', correlation)
    print('The p-value is:', p_value)
    #good correlation and p-value

    The correlation coefficient is: 0.778853671120664
    The p-value is: 2.59720928857378e-38

    #or silt
    df= data[data['block'].str.contains("silt")]
    df

          cultivar variety block  tree_number  fruit_number  fruit_diameter  \
    3150  Mandarin    Orri  silt          1.0           1.0           28.40   
    3151  Mandarin    Orri  silt          1.0           2.0           25.70   
    3152  Mandarin    Orri  silt          1.0           3.0           38.00   
    3153  Mandarin    Orri  silt          1.0           4.0           36.00   
    3154  Mandarin    Orri  silt          1.0           5.0           28.80   
    ...        ...     ...   ...          ...           ...             ...   
    4545  Mandarin    Orri  silt          4.0          21.0           82.33   
    4546  Mandarin    Orri  silt          4.0          22.0           78.39   
    4547  Mandarin    Orri  silt          4.0          23.0           68.61   
    4548  Mandarin    Orri  silt          4.0          24.0           88.40   
    4549  Mandarin    Orri  silt          4.0          25.0             NaN   

          Av_fruit_diameter date_of_measure  relative_mm_increment  \
    3150                NaN      26/07/2021                    NaN   
    3151                NaN      26/07/2021                    NaN   
    3152                NaN      26/07/2021                    NaN   
    3153                NaN      26/07/2021                    NaN   
    3154                NaN      26/07/2021                    NaN   
    ...                 ...             ...                    ...   
    4545                NaN      23/02/2022                   2.26   
    4546                NaN      23/02/2022                   1.40   
    4547                NaN      23/02/2022                   1.06   
    4548                NaN      23/02/2022                   2.60   
    4549                NaN      23/02/2022                    NaN   

          absolute_mm_increment  ...  monthly_ehu_27_35  relative_precipitation  \
    3150                    NaN  ...                NaN                     NaN   
    3151                    NaN  ...                NaN                     NaN   
    3152                    NaN  ...                NaN                     NaN   
    3153                    NaN  ...                NaN                     NaN   
    3154                    NaN  ...                NaN                     NaN   
    ...                     ...  ...                ...                     ...   
    4545                  51.43  ...                NaN                     NaN   
    4546                  53.39  ...                NaN                     NaN   
    4547                  42.21  ...                NaN                     NaN   
    4548                  53.80  ...                NaN                     NaN   
    4549                    NaN  ...                NaN                     NaN   

          monthly_precipitation relative_humidity total_relative_radiation(Mj/m2)  \
    3150                    NaN               NaN                             NaN   
    3151                    NaN               NaN                             NaN   
    3152                    NaN               NaN                             NaN   
    3153                    NaN               NaN                             NaN   
    3154                    NaN               NaN                             NaN   
    ...                     ...               ...                             ...   
    4545                    NaN               NaN                             NaN   
    4546                    NaN               NaN                             NaN   
    4547                    NaN               NaN                             NaN   
    4548                    NaN               NaN                             NaN   
    4549                    NaN               NaN                             NaN   

         total_radiation_per_month peel_color  coordinates  date_of_year  \
    3150                       NaN        NaN          NaN           207   
    3151                       NaN        NaN          NaN           207   
    3152                       NaN        NaN          NaN           207   
    3153                       NaN        NaN          NaN           207   
    3154                       NaN        NaN          NaN           207   
    ...                        ...        ...          ...           ...   
    4545                       NaN        NaN          NaN            54   
    4546                       NaN        NaN          NaN            54   
    4547                       NaN        NaN          NaN            54   
    4548                       NaN        NaN          NaN            54   
    4549                       NaN        NaN          NaN            54   

          date_of_year_group  
    3150                july  
    3151                july  
    3152                july  
    3153                july  
    3154                july  
    ...                  ...  
    4545                 feb  
    4546                 feb  
    4547                 feb  
    4548                 feb  
    4549                 feb  

    [1400 rows x 64 columns]

    correlation, p_value = pearson_correlation(df, 'dec', 'absolut_fruit_growth_rate', 'fruit_diameter')
    print('The correlation coefficient is:', correlation)
    print('The p-value is:', p_value)

    The correlation coefficient is: 0.7114831577895646
    The p-value is: 5.3483732613158145e-28

agr comparison of 10% big, 10% small and the 80% average

    #steps
    #divide the dataset per block for 10% small, 10% big and 80% average based on the fruit diameter at july
    #get the absoult fruit growth rate of each sub-group at december

    #or lul all season
    df= data[data['block'].str.contains("lul_2022") | data['block'].str.contains("lul_2020") | data['block'].str.contains("lul_2021") | data['block'].str.contains("or_lul_2022")]
    df

           cultivar variety        block  tree_number  fruit_number  \
    1400   Mandarin    Orri     lul_2022          1.0           1.0   
    1401   Mandarin    Orri     lul_2022          1.0           2.0   
    1402   Mandarin    Orri     lul_2022          1.0           3.0   
    1403   Mandarin    Orri     lul_2022          1.0           4.0   
    1404   Mandarin    Orri     lul_2022          1.0           5.0   
    ...         ...     ...          ...          ...           ...   
    26131  Mandarin    Orri  or_lul_2022          5.0           6.0   
    26132  Mandarin    Orri  or_lul_2022          5.0           7.0   
    26133  Mandarin    Orri  or_lul_2022          5.0           8.0   
    26134  Mandarin    Orri  or_lul_2022          5.0           9.0   
    26135  Mandarin    Orri  or_lul_2022          5.0          10.0   

           fruit_diameter  Av_fruit_diameter date_of_measure  \
    1400             33.8                NaN      26/07/2021   
    1401             33.1                NaN      26/07/2021   
    1402             31.8                NaN      26/07/2021   
    1403             31.3                NaN      26/07/2021   
    1404             33.2                NaN      26/07/2021   
    ...               ...                ...             ...   
    26131             NaN                NaN      18/01/2023   
    26132             NaN                NaN      18/01/2023   
    26133             NaN                NaN      18/01/2023   
    26134             NaN                NaN      18/01/2023   
    26135             NaN                NaN      18/01/2023   

           relative_mm_increment  absolute_mm_increment  ...  monthly_ehu_27_35  \
    1400                     NaN                    NaN  ...                NaN   
    1401                     NaN                    NaN  ...                NaN   
    1402                     NaN                    NaN  ...                NaN   
    1403                     NaN                    NaN  ...                NaN   
    1404                     NaN                    NaN  ...                NaN   
    ...                      ...                    ...  ...                ...   
    26131                    NaN                  36.93  ...                NaN   
    26132                    NaN                  37.00  ...                NaN   
    26133                    NaN                  35.88  ...                NaN   
    26134                    NaN                  41.21  ...                NaN   
    26135                    NaN                  45.42  ...                NaN   

           relative_precipitation  monthly_precipitation relative_humidity  \
    1400                      NaN                    NaN               NaN   
    1401                      NaN                    NaN               NaN   
    1402                      NaN                    NaN               NaN   
    1403                      NaN                    NaN               NaN   
    1404                      NaN                    NaN               NaN   
    ...                       ...                    ...               ...   
    26131                     NaN                    NaN               NaN   
    26132                     NaN                    NaN               NaN   
    26133                     NaN                    NaN               NaN   
    26134                     NaN                    NaN               NaN   
    26135                     NaN                    NaN               NaN   

          total_relative_radiation(Mj/m2) total_radiation_per_month peel_color  \
    1400                              NaN                       NaN        NaN   
    1401                              NaN                       NaN        NaN   
    1402                              NaN                       NaN        NaN   
    1403                              NaN                       NaN        NaN   
    1404                              NaN                       NaN        NaN   
    ...                               ...                       ...        ...   
    26131                             NaN                       NaN        NaN   
    26132                             NaN                       NaN        NaN   
    26133                             NaN                       NaN        NaN   
    26134                             NaN                       NaN        NaN   
    26135                             NaN                       NaN        NaN   

           coordinates  date_of_year  date_of_year_group  
    1400           NaN           207                july  
    1401           NaN           207                july  
    1402           NaN           207                july  
    1403           NaN           207                july  
    1404           NaN           207                july  
    ...            ...           ...                 ...  
    26131          NaN            18                 jan  
    26132          NaN            18                 jan  
    26133          NaN            18                 jan  
    26134          NaN            18                 jan  
    26135          NaN            18                 jan  

    [5675 rows x 64 columns]

    #extract the AGR at December of the 10% lower fruit diameter at august per block
    def lower_10th(df_per_block):
        aug_group_df= df_per_block[df_per_block['date_of_year_group']=='aug']
        lower_percentile= aug_group_df['fruit_diameter'].quantile(0.1)
        aug_group_df['fruit_diameter_group'] = pd.cut(aug_group_df['fruit_diameter'], bins=[-float('inf'), lower_percentile, float('inf')], labels=['lower', 'higher'])
        low_aug_grouped_df = aug_group_df[aug_group_df['fruit_diameter_group']=='lower']
        merged_df = pd.merge(low_aug_grouped_df, df_per_block, on=['cultivar', 'variety', 'block', 'tree_number', 'fruit_number'], how='inner')
        result_df = merged_df[merged_df['date_of_year_group_y'] == 'dec'].drop_duplicates(subset=['cultivar', 'variety', 'block', 'tree_number', 'fruit_number'], keep='first')
        lower_10th= result_df['absolut_fruit_growth_rate_x']
        return lower_10th

    lower_10th(df)

    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_27820/2210485274.py:5: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead

    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      aug_group_df['fruit_diameter_group'] = pd.cut(aug_group_df['fruit_diameter'], bins=[-float('inf'), lower_percentile, float('inf')], labels=['lower', 'higher'])

    8       0.237500
    22      0.258750
    36      0.315000
    50      0.199375
    64      0.162500
    78      0.115000
    92      0.213750
    108     0.050000
    127     0.337500
    146     0.312500
    165     0.262500
    184     0.193750
    222     0.212500
    241     0.356250
    260     0.287500
    279     0.206250
    298     0.293750
    317     0.206250
    336     0.306250
    355     0.175000
    374     0.325000
    393     0.268750
    412     0.268750
    431     0.137500
    469     0.181250
    507     0.275000
    526     0.268750
    545     0.218750
    583     0.218750
    602     0.250000
    621     0.181250
    640     0.306250
    659     0.300000
    678     0.181250
    716     0.256250
    735     0.200000
    773     0.093750
    792     0.331250
    811     0.343750
    830     0.300000
    849     0.312500
    868     0.243750
    887     0.337500
    906     0.318750
    924     0.241379
    936     0.310345
    948     0.310345
    960     0.275862
    972     0.241379
    984     0.275862
    1004    0.298667
    1011    0.205333
    1018    0.216333
    1025    0.198333
    1032    0.232000
    1039    0.289000
    1046    0.277333
    1053    0.303000
    1060    0.179667
    1067    0.212667
    Name: absolut_fruit_growth_rate_x, dtype: float64

    #extract the AGR at December of the 10% higher fruit diameter at august per block
    def higher_90th(df_per_block):
        aug_group_df= df_per_block[df_per_block['date_of_year_group']=='aug']
        upper_range= aug_group_df['fruit_diameter'].quantile(0.9)
        aug_group_df['fruit_diameter_group'] = pd.cut(aug_group_df['fruit_diameter'], bins=[-float('inf'), upper_range, float('inf')], labels=['lower', 'higher'])
        upper_aug_grouped_df = aug_group_df[aug_group_df['fruit_diameter_group']=='higher']
        merged_df = pd.merge(upper_aug_grouped_df, df_per_block, on=['cultivar', 'variety', 'block', 'tree_number', 'fruit_number'], how='inner')
        result_df = merged_df[merged_df['date_of_year_group_y'] == 'dec'].drop_duplicates(subset=['cultivar', 'variety', 'block', 'tree_number', 'fruit_number'], keep='first')
        upper_10th= result_df['absolut_fruit_growth_rate_x']
        return upper_10th

    higher_90th(df)

    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_27820/2382774398.py:5: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead

    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      aug_group_df['fruit_diameter_group'] = pd.cut(aug_group_df['fruit_diameter'], bins=[-float('inf'), upper_range, float('inf')], labels=['lower', 'higher'])

    8      0.331250
    22     0.400000
    36     0.412500
    50     0.418750
    64          NaN
    78     0.506250
    94     0.386667
    113    0.433333
    132    0.403333
    151    0.433333
    170    0.483333
    189    0.483333
    208    0.440000
    227    0.430000
    246    0.410000
    264    0.517241
    288    0.448276
    312    0.448276
    336    0.379310
    360    0.448276
    384    0.413793
    408    0.413793
    432    0.413793
    456    0.517241
    480    0.379310
    504    0.409091
    516    0.454545
    528    0.454545
    540    0.454545
    552    0.431818
    564    0.386364
    576    0.409091
    588    0.340909
    600    0.477273
    612    0.454545
    624    0.431818
    636    0.363636
    648    0.386364
    660    0.363636
    672    0.409091
    684    0.409091
    696    0.409091
    708    0.409091
    720    0.477273
    732    0.363636
    744    0.431818
    756    0.295455
    768    0.318182
    780    0.340909
    792    0.409091
    804    0.340909
    816    0.340909
    Name: absolut_fruit_growth_rate_x, dtype: float64

    #extract the AGR at December of the 10-90% fruit diameter at august per block
    def upper_lower_rgr(df_per_block):
        upper_lower_th= []
        aug_group_df= df_per_block[df_per_block['date_of_year_group']=='aug']
        upper_range= aug_group_df['fruit_diameter'].quantile(0.9)
        lower_range= aug_group_df['fruit_diameter'].quantile(0.1)
        upper_lower= aug_group_df[(aug_group_df['fruit_diameter']>lower_range) & (aug_group_df['fruit_diameter']<upper_range)]
        aug_group_df['fruit_diameter_group'] = pd.cut(aug_group_df['fruit_diameter'], bins=[-float('inf'), lower_range, upper_range, float('inf')], labels=['lower', 'average', 'higher'])
        upper_lower_aug_grouped_df = aug_group_df[aug_group_df['fruit_diameter_group']=='average']
        merged_df = pd.merge(upper_lower_aug_grouped_df, df_per_block, on=['cultivar', 'variety', 'block', 'tree_number', 'fruit_number'], how='inner')
        result_df = merged_df[merged_df['date_of_year_group_y'] == 'dec'].drop_duplicates(subset=['cultivar', 'variety', 'block', 'tree_number', 'fruit_number'], keep='first')
        upper_lower_th= result_df['absolut_fruit_growth_rate_x']
        return upper_lower_th

    upper_lower_rgr(df)
    #there are a lot of samples compared to the lower/upper ranges. making anova will reduce the number of samples

    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_27820/2391912971.py:8: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead

    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      aug_group_df['fruit_diameter_group'] = pd.cut(aug_group_df['fruit_diameter'], bins=[-float('inf'), lower_range, upper_range, float('inf')], labels=['lower', 'average', 'higher'])

    8       0.331250
    22      0.412500
    36      0.375000
    50      0.368750
    64      0.431250
              ...   
    7332    0.309000
    7339    0.299667
    7346    0.361000
    7353    0.228000
    7360    0.356000
    Name: absolut_fruit_growth_rate_x, Length: 360, dtype: float64

    def AGR_lower_average_upper(df_per_block):
        lower_10th= []
        upper_lower_th= []
        upper_10th= []
        aug_group_df= df_per_block[df_per_block['date_of_year_group']=='aug']
        lower_range= aug_group_df['fruit_diameter'].quantile(0.1)
        upper_range= aug_group_df['fruit_diameter'].quantile(0.9)
        upper_lower= aug_group_df[(aug_group_df['fruit_diameter']>lower_range) & (aug_group_df['fruit_diameter']<upper_range)]
        aug_group_df['fruit_diameter_group'] = pd.cut(aug_group_df['fruit_diameter'], bins=[-float('inf'), lower_range, upper_range, float('inf')], labels=['lower', 'average', 'higher'])
        low_aug_grouped_df = aug_group_df[aug_group_df['fruit_diameter_group']=='lower']
        merged_df_lower = pd.merge(low_aug_grouped_df, df_per_block, on=['cultivar', 'variety', 'block', 'tree_number', 'fruit_number'], how='inner')
        result_df_lower = merged_df_lower[merged_df_lower['date_of_year_group_y'] == 'dec'].drop_duplicates(subset=['cultivar', 'variety', 'block', 'tree_number', 'fruit_number'], keep='first')
        lower_10th= result_df_lower['absolut_fruit_growth_rate_x']
        av_aug_grouped_df = aug_group_df[aug_group_df['fruit_diameter_group']=='average']
        merged_df_av = pd.merge(av_aug_grouped_df, df_per_block, on=['cultivar', 'variety', 'block', 'tree_number', 'fruit_number'], how='inner')
        result_df_av = merged_df_av[merged_df_av['date_of_year_group_y'] == 'dec'].drop_duplicates(subset=['cultivar', 'variety', 'block', 'tree_number', 'fruit_number'], keep='first')
        upper_lower_th= result_df_av['absolut_fruit_growth_rate_x']
        high_aug_grouped_df = aug_group_df[aug_group_df['fruit_diameter_group']=='higher']
        merged_df_higher = pd.merge(high_aug_grouped_df, df_per_block, on=['cultivar', 'variety', 'block', 'tree_number', 'fruit_number'], how='inner')
        result_df_higher = merged_df_higher[merged_df_higher['date_of_year_group_y'] == 'dec'].drop_duplicates(subset=['cultivar', 'variety', 'block', 'tree_number', 'fruit_number'], keep='first')
        upper_10th= result_df_higher['absolut_fruit_growth_rate_x']
        AGR_df=pd.DataFrame({'lower_10th':lower_10th, '10%-90% of data':upper_lower_th, 'upper_10th':upper_10th})
        return AGR_df

    rgr_thresholds= AGR_lower_average_upper(df)
    rgr_thresholds

    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_27820/959906336.py:9: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead

    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      aug_group_df['fruit_diameter_group'] = pd.cut(aug_group_df['fruit_diameter'], bins=[-float('inf'), lower_range, upper_range, float('inf')], labels=['lower', 'average', 'higher'])

          lower_10th  10%-90% of data  upper_10th
    8       0.237500         0.331250     0.33125
    22      0.258750         0.412500     0.40000
    36      0.315000         0.375000     0.41250
    50      0.199375         0.368750     0.41875
    64      0.162500         0.431250         NaN
    ...          ...              ...         ...
    7332         NaN         0.309000         NaN
    7339         NaN         0.299667         NaN
    7346         NaN         0.361000         NaN
    7353         NaN         0.228000         NaN
    7360         NaN         0.356000         NaN

    [447 rows x 3 columns]

    rgr_thresholds.boxplot()
    plt.xlabel('AGR thresholds')
    plt.ylabel('AGR at the end of the season')
    plt.title('or lul AGR of small,av,big fruits at the end of the season')
    plt.show()

[]

    #anova between the AGR ranges
    from scipy.stats import f_oneway
    cols = ['lower_10th', '10%-90% of data', 'upper_10th']
    rgr_thresholds = rgr_thresholds[cols].dropna()
    fvalue, pvalue = f_oneway(rgr_thresholds['lower_10th'],rgr_thresholds['10%-90% of data'],rgr_thresholds['upper_10th'])
    print('F-value:', fvalue)
    print('P-value:', pvalue)

    F-value: 14.057209361564146
    P-value: 0.000363927964729427

there is a statistically significant in the AGR between the different fruit size

    #HSD test
    import statsmodels.stats.multicomp as mc
    rgr_var = [rgr_thresholds['lower_10th'], rgr_thresholds['10%-90% of data'], rgr_thresholds['upper_10th']]
    cols = ['lower_10th', '10%-90% of data', 'upper_10th']
    tukey = mc.MultiComparison(np.hstack(rgr_var), np.hstack([[i] * len(d) for i, d in enumerate(rgr_var)]))
    result = tukey.tukeyhsd()
    print(result)

    Multiple Comparison of Means - Tukey HSD, FWER=0.05
    ===================================================
    group1 group2 meandiff p-adj   lower  upper  reject
    ---------------------------------------------------
         0      1   0.1291 0.0042  0.0421 0.2161   True
         0      2   0.1702 0.0004  0.0832 0.2572   True
         1      2   0.0411 0.4561 -0.0459 0.1281  False
    ---------------------------------------------------

    #there is a significant difference between the lower and 10%-90% group of data
    #there is a significant difference between the lower and upper group of data
    #there is a no significant difference between the 10%-90% group of data and the upper group

or 2011, season 2021-2022, 2022-2023

    df= data[data['block'].str.contains("2011_2021") | data['block'].str.contains("or 2011_2022")]
    df

           cultivar variety         block  tree_number  fruit_number  \
    4550   Mandarin    Orri     2011_2021          1.0           1.0   
    4551   Mandarin    Orri     2011_2021          1.0           2.0   
    4552   Mandarin    Orri     2011_2021          1.0           3.0   
    4553   Mandarin    Orri     2011_2021          1.0           4.0   
    4554   Mandarin    Orri     2011_2021          1.0           5.0   
    ...         ...     ...           ...          ...           ...   
    26481  Mandarin    Orri  or 2011_2022          5.0           6.0   
    26482  Mandarin    Orri  or 2011_2022          5.0           7.0   
    26483  Mandarin    Orri  or 2011_2022          5.0           8.0   
    26484  Mandarin    Orri  or 2011_2022          5.0           9.0   
    26485  Mandarin    Orri  or 2011_2022          5.0          10.0   

           fruit_diameter  Av_fruit_diameter date_of_measure  \
    4550            33.33                NaN      26/07/2021   
    4551            32.53                NaN      26/07/2021   
    4552            27.28                NaN      26/07/2021   
    4553            29.67                NaN      26/07/2021   
    4554            34.14                NaN      26/07/2021   
    ...               ...                ...             ...   
    26481           74.92            75.2075      18/01/2023   
    26482           80.20            75.2075      18/01/2023   
    26483           75.91            75.2075      18/01/2023   
    26484             NaN            75.2075      18/01/2023   
    26485           76.77            75.2075      18/01/2023   

           relative_mm_increment  absolute_mm_increment  ...  monthly_ehu_27_35  \
    4550                     NaN                    NaN  ...                NaN   
    4551                     NaN                    NaN  ...                NaN   
    4552                     NaN                    NaN  ...                NaN   
    4553                     NaN                    NaN  ...                NaN   
    4554                     NaN                    NaN  ...                NaN   
    ...                      ...                    ...  ...                ...   
    26481                   3.42                  27.82  ...                NaN   
    26482                   0.54                  25.97  ...                NaN   
    26483                   1.74                  26.20  ...                NaN   
    26484                    NaN                    NaN  ...                NaN   
    26485                   2.32                  28.38  ...                NaN   

           relative_precipitation  monthly_precipitation relative_humidity  \
    4550                      NaN                    NaN               NaN   
    4551                      NaN                    NaN               NaN   
    4552                      NaN                    NaN               NaN   
    4553                      NaN                    NaN               NaN   
    4554                      NaN                    NaN               NaN   
    ...                       ...                    ...               ...   
    26481                     NaN                    NaN               NaN   
    26482                     NaN                    NaN               NaN   
    26483                     NaN                    NaN               NaN   
    26484                     NaN                    NaN               NaN   
    26485                     NaN                    NaN               NaN   

          total_relative_radiation(Mj/m2) total_radiation_per_month peel_color  \
    4550                              NaN                       NaN        NaN   
    4551                              NaN                       NaN        NaN   
    4552                              NaN                       NaN        NaN   
    4553                              NaN                       NaN        NaN   
    4554                              NaN                       NaN        NaN   
    ...                               ...                       ...        ...   
    26481                             NaN                       NaN        NaN   
    26482                             NaN                       NaN        NaN   
    26483                             NaN                       NaN        NaN   
    26484                             NaN                       NaN        NaN   
    26485                             NaN                       NaN        NaN   

           coordinates  date_of_year  date_of_year_group  
    4550           NaN           207                july  
    4551           NaN           207                july  
    4552           NaN           207                july  
    4553           NaN           207                july  
    4554           NaN           207                july  
    ...            ...           ...                 ...  
    26481          NaN            18                 jan  
    26482          NaN            18                 jan  
    26483          NaN            18                 jan  
    26484          NaN            18                 jan  
    26485          NaN            18                 jan  

    [1932 rows x 64 columns]

    lower_10th(df)

    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_27820/2210485274.py:5: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead

    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      aug_group_df['fruit_diameter_group'] = pd.cut(aug_group_df['fruit_diameter'], bins=[-float('inf'), lower_percentile, float('inf')], labels=['lower', 'higher'])

    8           NaN
    22          NaN
    36          NaN
    50          NaN
    64          NaN
    78     0.013825
    92     0.013825
    106    0.123750
    120    0.076875
    134    0.007500
    148    0.093633
    162    0.093633
    176    0.093633
    190    0.018750
    204    0.012500
    218    0.093750
    229    0.148000
    Name: absolut_fruit_growth_rate_x, dtype: float64

    rgr_thresholds= AGR_lower_average_upper(df)
    rgr_thresholds

    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_27820/959906336.py:9: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead

    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      aug_group_df['fruit_diameter_group'] = pd.cut(aug_group_df['fruit_diameter'], bins=[-float('inf'), lower_range, upper_range, float('inf')], labels=['lower', 'average', 'higher'])

          lower_10th  10%-90% of data  upper_10th
    8            NaN         0.055625    0.121250
    22           NaN         0.027500    0.176250
    33           NaN              NaN    0.319429
    36           NaN              NaN         NaN
    40           NaN              NaN    0.355714
    ...          ...              ...         ...
    1517         NaN         0.328000         NaN
    1524         NaN         0.392571         NaN
    1531         NaN         0.403429         NaN
    1538         NaN         0.232286         NaN
    1545         NaN         0.346571         NaN

    [143 rows x 3 columns]

    rgr_thresholds.boxplot()
    plt.xlabel('AGR thresholds')
    plt.ylabel('AGR at the end of the season')
    plt.title('or lul AGR of small,av,big fruits at the end of the season')
    plt.show()

[]

    #anova between the AGR ranges
    from scipy.stats import f_oneway
    cols = ['lower_10th', '10%-90% of data', 'upper_10th']
    rgr_thresholds = rgr_thresholds[cols].dropna()
    fvalue, pvalue = f_oneway(rgr_thresholds['lower_10th'],rgr_thresholds['10%-90% of data'],rgr_thresholds['upper_10th'])
    print('F-value:', fvalue)
    print('P-value:', pvalue)
    #there is not enough of sample to make anova test for 2011 blocks

    F-value: nan
    P-value: nan

    /Users/einatrotzak/opt/anaconda3/lib/python3.9/site-packages/scipy/stats/_stats_py.py:3869: DegenerateDataWarning: at least one input has length 0
      warnings.warn(stats.DegenerateDataWarning('at least one input '

or gromosol season 2022-2023

    df= data[data['block'].str.contains("gromosoll")]
    df

           cultivar variety      block  tree_number  fruit_number  fruit_diameter  \
    26486  Mandarin    Orri  gromosoll          1.0           1.0           26.27   
    26487  Mandarin    Orri  gromosoll          1.0           2.0           21.40   
    26488  Mandarin    Orri  gromosoll          1.0           3.0           26.70   
    26489  Mandarin    Orri  gromosoll          1.0           4.0           26.41   
    26490  Mandarin    Orri  gromosoll          1.0           5.0           19.98   
    ...         ...     ...        ...          ...           ...             ...   
    26901  Mandarin    Orri  gromosoll          7.0           6.0           65.70   
    26902  Mandarin    Orri  gromosoll          7.0           7.0           65.02   
    26903  Mandarin    Orri  gromosoll          7.0           8.0           68.10   
    26904  Mandarin    Orri  gromosoll          7.0           9.0           69.00   
    26905  Mandarin    Orri  gromosoll          7.0          10.0           64.37   

           Av_fruit_diameter date_of_measure  relative_mm_increment  \
    26486             21.624      20/07/2022                    NaN   
    26487             21.624      20/07/2022                    NaN   
    26488             21.624      20/07/2022                    NaN   
    26489             21.624      20/07/2022                    NaN   
    26490             21.624      20/07/2022                    NaN   
    ...                  ...             ...                    ...   
    26901             67.693      27/12/2022                   7.66   
    26902             67.693      27/12/2022                   9.64   
    26903             67.693      27/12/2022                   7.86   
    26904             67.693      27/12/2022                   9.40   
    26905             67.693      27/12/2022                   5.78   

           absolute_mm_increment  ...  monthly_ehu_27_35  relative_precipitation  \
    26486                    NaN  ...                NaN                     NaN   
    26487                    NaN  ...                NaN                     NaN   
    26488                    NaN  ...                NaN                     NaN   
    26489                    NaN  ...                NaN                     NaN   
    26490                    NaN  ...                NaN                     NaN   
    ...                      ...  ...                ...                     ...   
    26901                  43.69  ...                NaN                     NaN   
    26902                  44.73  ...                NaN                     NaN   
    26903                  45.98  ...                NaN                     NaN   
    26904                  42.24  ...                NaN                     NaN   
    26905                  41.21  ...                NaN                     NaN   

           monthly_precipitation relative_humidity  \
    26486                    NaN               NaN   
    26487                    NaN               NaN   
    26488                    NaN               NaN   
    26489                    NaN               NaN   
    26490                    NaN               NaN   
    ...                      ...               ...   
    26901                    NaN               NaN   
    26902                    NaN               NaN   
    26903                    NaN               NaN   
    26904                    NaN               NaN   
    26905                    NaN               NaN   

          total_relative_radiation(Mj/m2) total_radiation_per_month peel_color  \
    26486                             NaN                       NaN        NaN   
    26487                             NaN                       NaN        NaN   
    26488                             NaN                       NaN        NaN   
    26489                             NaN                       NaN        NaN   
    26490                             NaN                       NaN        NaN   
    ...                               ...                       ...        ...   
    26901                             NaN                       NaN        NaN   
    26902                             NaN                       NaN        NaN   
    26903                             NaN                       NaN        NaN   
    26904                             NaN                       NaN        NaN   
    26905                             NaN                       NaN        NaN   

           coordinates  date_of_year  date_of_year_group  
    26486          NaN           201                july  
    26487          NaN           201                july  
    26488          NaN           201                july  
    26489          NaN           201                july  
    26490          NaN           201                july  
    ...            ...           ...                 ...  
    26901          NaN           361                 dec  
    26902          NaN           361                 dec  
    26903          NaN           361                 dec  
    26904          NaN           361                 dec  
    26905          NaN           361                 dec  

    [420 rows x 64 columns]

    rgr_thresholds= AGR_lower_average_upper(df)
    rgr_thresholds

    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_27820/959906336.py:9: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead

    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      aug_group_df['fruit_diameter_group'] = pd.cut(aug_group_df['fruit_diameter'], bins=[-float('inf'), lower_range, upper_range, float('inf')], labels=['lower', 'average', 'higher'])

         lower_10th  10%-90% of data  upper_10th
    5      0.225833         0.399444    0.362778
    11     0.336389         0.367778    0.396944
    17     0.195000         0.531944    0.371111
    23     0.225556         0.412500    0.312222
    29     0.304722         0.263333    0.363889
    35     0.115833         0.375833    0.361944
    41     0.179722         0.390833    0.236111
    47          NaN         0.311667         NaN
    53          NaN         0.319722         NaN
    59          NaN         0.231111         NaN
    65          NaN         0.246667         NaN
    71          NaN         0.277500         NaN
    77          NaN         0.267778         NaN
    83          NaN         0.321389         NaN
    89          NaN         0.347222         NaN
    95          NaN         0.137500         NaN
    101         NaN         0.204167         NaN
    107         NaN         0.301389         NaN
    113         NaN         0.349167         NaN
    119         NaN         0.301111         NaN
    125         NaN         0.229167         NaN
    131         NaN         0.321111         NaN
    137         NaN         0.253611         NaN
    143         NaN         0.345833         NaN
    149         NaN         0.270278         NaN
    155         NaN         0.321667         NaN
    161         NaN         0.331389         NaN
    167         NaN         0.356667         NaN
    173         NaN         0.301667         NaN
    179         NaN         0.270833         NaN
    185         NaN         0.325556         NaN
    191         NaN         0.346111         NaN
    197         NaN         0.345278         NaN
    203         NaN         0.264444         NaN
    209         NaN         0.319167         NaN
    215         NaN         0.387222         NaN
    221         NaN         0.310278         NaN
    227         NaN         0.379444         NaN
    233         NaN         0.306667         NaN
    239         NaN         0.244444         NaN
    245         NaN         0.172500         NaN
    251         NaN         0.216389         NaN
    257         NaN         0.143056         NaN
    263         NaN         0.188611         NaN
    269         NaN         0.248056         NaN
    275         NaN         0.196389         NaN
    281         NaN         0.274444         NaN
    287         NaN         0.177778         NaN
    293         NaN         0.286667         NaN
    299         NaN         0.281944         NaN
    305         NaN         0.311389         NaN
    311         NaN         0.291667         NaN
    317         NaN         0.268333         NaN
    323         NaN         0.295556         NaN
    329         NaN         0.254722         NaN
    335         NaN         0.265000         NaN

    rgr_thresholds.boxplot()
    plt.xlabel('AGR thresholds')
    plt.ylabel('AGR at the end of the season')
    plt.title('or lul AGR of small,av,big fruits at the end of the season')
    plt.show()

[]

    #anova between the AGR ranges
    from scipy.stats import f_oneway
    cols = ['lower_10th', '10%-90% of data', 'upper_10th']
    rgr_thresholds = rgr_thresholds[cols].dropna()
    fvalue, pvalue = f_oneway(rgr_thresholds['lower_10th'],rgr_thresholds['10%-90% of data'],rgr_thresholds['upper_10th'])
    print('F-value:', fvalue)
    print('P-value:', pvalue)

    F-value: 10.33948526122121
    P-value: 0.0010237134005287457

    #HSD test
    import statsmodels.stats.multicomp as mc
    rgr_var = [rgr_thresholds['lower_10th'], rgr_thresholds['10%-90% of data'], rgr_thresholds['upper_10th']]
    cols = ['lower_10th', '10%-90% of data', 'upper_10th']
    tukey = mc.MultiComparison(np.hstack(rgr_var), np.hstack([[i] * len(d) for i, d in enumerate(rgr_var)]))
    result = tukey.tukeyhsd()
    print(result)
    #same trend

    Multiple Comparison of Means - Tukey HSD, FWER=0.05
    ===================================================
    group1 group2 meandiff p-adj   lower  upper  reject
    ---------------------------------------------------
         0      1   0.1655 0.0009  0.0699 0.2611   True
         0      2   0.1174  0.015  0.0219  0.213   True
         1      2  -0.0481 0.4217 -0.1437 0.0475  False
    ---------------------------------------------------

if 90% of the data is within the av and high size , we can predict the av size at picking using the same FGR

let's try it for all the data of mandarin from the same fruit measurement

    df= data[data['block'].str.contains("2011_2021") | data['block'].str.contains("or 2011_2022")
            | data['block'].str.contains("11")| data['block'].str.contains("26")
            | data['block'].str.contains("30")| data['block'].str.contains("36")
            | data['block'].str.contains("chile")| data['block'].str.contains("east")| data['block'].str.contains("gromosoll")
            | data['block'].str.contains("lul_2020")| data['block'].str.contains("lul_2021")| data['block'].str.contains("lul_2022")
            | data['block'].str.contains("or_lul_2022")| data['block'].str.contains("rendzinaa")| data['block'].str.contains("silt")
            ]
    df

           cultivar variety      block  tree_number  fruit_number  fruit_diameter  \
    0      Mandarin    Orri       east          1.0           1.0           23.00   
    1      Mandarin    Orri       east          1.0           2.0           20.60   
    2      Mandarin    Orri       east          1.0           3.0           17.20   
    3      Mandarin    Orri       east          1.0           4.0           22.90   
    4      Mandarin    Orri       east          1.0           5.0           25.60   
    ...         ...     ...        ...          ...           ...             ...   
    27566  Mandarin    Orri  rendzinaa          5.0           6.0           55.92   
    27567  Mandarin    Orri  rendzinaa          5.0           7.0           56.19   
    27568  Mandarin    Orri  rendzinaa          5.0           8.0             NaN   
    27569  Mandarin    Orri  rendzinaa          5.0           9.0           66.33   
    27570  Mandarin    Orri  rendzinaa          5.0          10.0           58.35   

           Av_fruit_diameter date_of_measure  relative_mm_increment  \
    0                    NaN      26/07/2021                    NaN   
    1                    NaN      26/07/2021                    NaN   
    2                    NaN      26/07/2021                    NaN   
    3                    NaN      26/07/2021                    NaN   
    4                    NaN      26/07/2021                    NaN   
    ...                  ...             ...                    ...   
    27566                NaN      27/12/2022                   6.20   
    27567                NaN      27/12/2022                   7.56   
    27568                NaN      27/12/2022                    NaN   
    27569                NaN      27/12/2022                   7.54   
    27570                NaN      27/12/2022                   5.92   

           absolute_mm_increment  ...  monthly_ehu_27_35  relative_precipitation  \
    0                        NaN  ...                NaN                     NaN   
    1                        NaN  ...                NaN                     NaN   
    2                        NaN  ...                NaN                     NaN   
    3                        NaN  ...                NaN                     NaN   
    4                        NaN  ...                NaN                     NaN   
    ...                      ...  ...                ...                     ...   
    27566                  39.57  ...                NaN                     NaN   
    27567                  37.61  ...                NaN                     NaN   
    27568                    NaN  ...                NaN                     NaN   
    27569                  40.18  ...                NaN                     NaN   
    27570                  33.85  ...                NaN                     NaN   

           monthly_precipitation relative_humidity  \
    0                        NaN               NaN   
    1                        NaN               NaN   
    2                        NaN               NaN   
    3                        NaN               NaN   
    4                        NaN               NaN   
    ...                      ...               ...   
    27566                    NaN               NaN   
    27567                    NaN               NaN   
    27568                    NaN               NaN   
    27569                    NaN               NaN   
    27570                    NaN               NaN   

          total_relative_radiation(Mj/m2) total_radiation_per_month peel_color  \
    0                                 NaN                       NaN        NaN   
    1                                 NaN                       NaN        NaN   
    2                                 NaN                       NaN        NaN   
    3                                 NaN                       NaN        NaN   
    4                                 NaN                       NaN        NaN   
    ...                               ...                       ...        ...   
    27566                             NaN                       NaN        NaN   
    27567                             NaN                       NaN        NaN   
    27568                             NaN                       NaN        NaN   
    27569                             NaN                       NaN        NaN   
    27570                             NaN                       NaN        NaN   

           coordinates  date_of_year  date_of_year_group  
    0              NaN           207                july  
    1              NaN           207                july  
    2              NaN           207                july  
    3              NaN           207                july  
    4              NaN           207                july  
    ...            ...           ...                 ...  
    27566          NaN           361                 dec  
    27567          NaN           361                 dec  
    27568          NaN           361                 dec  
    27569          NaN           361                 dec  
    27570          NaN           361                 dec  

    [21831 rows x 64 columns]

    lower_10th(df)

    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_27820/2210485274.py:5: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead

    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      aug_group_df['fruit_diameter_group'] = pd.cut(aug_group_df['fruit_diameter'], bins=[-float('inf'), lower_percentile, float('inf')], labels=['lower', 'higher'])

    8        0.175000
    22       0.162500
    36       0.162500
    50       0.250000
    64       0.237500
               ...   
    15697    0.383023
    15704    0.366512
    15711    0.316744
    15718    0.304186
    15725    0.303721
    Name: absolut_fruit_growth_rate_x, Length: 220, dtype: float64

    upper_lower_rgr(df)

    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_27820/2391912971.py:8: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead

    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      aug_group_df['fruit_diameter_group'] = pd.cut(aug_group_df['fruit_diameter'], bins=[-float('inf'), lower_range, upper_range, float('inf')], labels=['lower', 'average', 'higher'])

    8         0.262500
    22        0.287500
    36        0.275000
    50        0.281250
    64        0.225000
                ...   
    225882    0.380000
    225889         NaN
    225896    0.266744
    225903    0.309070
    225910    0.254884
    Name: absolut_fruit_growth_rate_x, Length: 1181, dtype: float64

    higher_90th(df)

    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_27820/2382774398.py:5: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead

    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      aug_group_df['fruit_diameter_group'] = pd.cut(aug_group_df['fruit_diameter'], bins=[-float('inf'), upper_range, float('inf')], labels=['lower', 'higher'])

    10      0.440000
    28      0.448276
    52      0.413793
    76      0.454545
    88      0.431818
              ...   
    3944    0.315714
    3959    0.320952
    3974    0.370714
    3983    0.441143
    3990    0.356857
    Name: absolut_fruit_growth_rate_x, Length: 146, dtype: float64

    rgr_thresholds= AGR_lower_average_upper(df)
    rgr_thresholds

    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_27820/959906336.py:9: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead

    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      aug_group_df['fruit_diameter_group'] = pd.cut(aug_group_df['fruit_diameter'], bins=[-float('inf'), lower_range, upper_range, float('inf')], labels=['lower', 'average', 'higher'])

            lower_10th  10%-90% of data  upper_10th
    8           0.1750         0.262500         NaN
    10             NaN              NaN    0.440000
    22          0.1625         0.287500         NaN
    28             NaN              NaN    0.448276
    36          0.1625         0.275000         NaN
    ...            ...              ...         ...
    225882         NaN         0.380000         NaN
    225889         NaN              NaN         NaN
    225896         NaN         0.266744         NaN
    225903         NaN         0.309070         NaN
    225910         NaN         0.254884         NaN

    [1407 rows x 3 columns]

    rgr_thresholds.boxplot()
    plt.xlabel('AGR thresholds')
    plt.ylabel('AGR at the end of the season')
    plt.title('or lul AGR of small,av,big fruits at the end of the season')
    plt.show()

[]

    #anova between the AGR ranges
    from scipy.stats import f_oneway
    cols = ['lower_10th', '10%-90% of data', 'upper_10th']
    rgr_thresholds = rgr_thresholds[cols].dropna()
    fvalue, pvalue = f_oneway(rgr_thresholds['lower_10th'],rgr_thresholds['10%-90% of data'],rgr_thresholds['upper_10th'])
    print('F-value:', fvalue)
    print('P-value:', pvalue)

    F-value: 8.491246752430806
    P-value: 0.017793538116702052

    #HSD test
    import statsmodels.stats.multicomp as mc
    rgr_var = [rgr_thresholds['lower_10th'], rgr_thresholds['10%-90% of data'], rgr_thresholds['upper_10th']]
    cols = ['lower_10th', '10%-90% of data', 'upper_10th']
    tukey = mc.MultiComparison(np.hstack(rgr_var), np.hstack([[i] * len(d) for i, d in enumerate(rgr_var)]))
    result = tukey.tukeyhsd()
    print(result)

    Multiple Comparison of Means - Tukey HSD, FWER=0.05
    ===================================================
    group1 group2 meandiff p-adj   lower  upper  reject
    ---------------------------------------------------
         0      1   0.1971 0.0294  0.0247 0.3695   True
         0      2   0.2038 0.0256  0.0314 0.3762   True
         1      2   0.0067 0.9922 -0.1657 0.1791  False
    ---------------------------------------------------

10% of the fruits that were small at the beginning of the season, will be small at the end of the season

fruits that were average size at the beginning of the season (10%-90%) can reach big size (>90%) at the end of the season, and big fruits (>90%) can reach av size at the end of the season (there is no significant difference in the AGR at december)

lets try it with 20% small, 60% average and 20% big

    #for all madnarins data

    df= data[data['block'].str.contains("2011_2021") | data['block'].str.contains("or 2011_2022")
            | data['block'].str.contains("11")| data['block'].str.contains("26")
            | data['block'].str.contains("30")| data['block'].str.contains("36")
            | data['block'].str.contains("chile")| data['block'].str.contains("east")| data['block'].str.contains("gromosoll")
            | data['block'].str.contains("lul_2020")| data['block'].str.contains("lul_2021")| data['block'].str.contains("lul_2022")
            | data['block'].str.contains("or_lul_2022")| data['block'].str.contains("rendzinaa")| data['block'].str.contains("silt")
            ]
    df

           cultivar variety      block  tree_number  fruit_number  fruit_diameter  \
    0      Mandarin    Orri       east          1.0           1.0           23.00   
    1      Mandarin    Orri       east          1.0           2.0           20.60   
    2      Mandarin    Orri       east          1.0           3.0           17.20   
    3      Mandarin    Orri       east          1.0           4.0           22.90   
    4      Mandarin    Orri       east          1.0           5.0           25.60   
    ...         ...     ...        ...          ...           ...             ...   
    27566  Mandarin    Orri  rendzinaa          5.0           6.0           55.92   
    27567  Mandarin    Orri  rendzinaa          5.0           7.0           56.19   
    27568  Mandarin    Orri  rendzinaa          5.0           8.0             NaN   
    27569  Mandarin    Orri  rendzinaa          5.0           9.0           66.33   
    27570  Mandarin    Orri  rendzinaa          5.0          10.0           58.35   

           Av_fruit_diameter date_of_measure  relative_mm_increment  \
    0                    NaN      26/07/2021                    NaN   
    1                    NaN      26/07/2021                    NaN   
    2                    NaN      26/07/2021                    NaN   
    3                    NaN      26/07/2021                    NaN   
    4                    NaN      26/07/2021                    NaN   
    ...                  ...             ...                    ...   
    27566                NaN      27/12/2022                   6.20   
    27567                NaN      27/12/2022                   7.56   
    27568                NaN      27/12/2022                    NaN   
    27569                NaN      27/12/2022                   7.54   
    27570                NaN      27/12/2022                   5.92   

           absolute_mm_increment  ...  monthly_ehu_27_35  relative_precipitation  \
    0                        NaN  ...                NaN                     NaN   
    1                        NaN  ...                NaN                     NaN   
    2                        NaN  ...                NaN                     NaN   
    3                        NaN  ...                NaN                     NaN   
    4                        NaN  ...                NaN                     NaN   
    ...                      ...  ...                ...                     ...   
    27566                  39.57  ...                NaN                     NaN   
    27567                  37.61  ...                NaN                     NaN   
    27568                    NaN  ...                NaN                     NaN   
    27569                  40.18  ...                NaN                     NaN   
    27570                  33.85  ...                NaN                     NaN   

           monthly_precipitation relative_humidity  \
    0                        NaN               NaN   
    1                        NaN               NaN   
    2                        NaN               NaN   
    3                        NaN               NaN   
    4                        NaN               NaN   
    ...                      ...               ...   
    27566                    NaN               NaN   
    27567                    NaN               NaN   
    27568                    NaN               NaN   
    27569                    NaN               NaN   
    27570                    NaN               NaN   

          total_relative_radiation(Mj/m2) total_radiation_per_month peel_color  \
    0                                 NaN                       NaN        NaN   
    1                                 NaN                       NaN        NaN   
    2                                 NaN                       NaN        NaN   
    3                                 NaN                       NaN        NaN   
    4                                 NaN                       NaN        NaN   
    ...                               ...                       ...        ...   
    27566                             NaN                       NaN        NaN   
    27567                             NaN                       NaN        NaN   
    27568                             NaN                       NaN        NaN   
    27569                             NaN                       NaN        NaN   
    27570                             NaN                       NaN        NaN   

           coordinates  date_of_year  date_of_year_group  
    0              NaN           207                july  
    1              NaN           207                july  
    2              NaN           207                july  
    3              NaN           207                july  
    4              NaN           207                july  
    ...            ...           ...                 ...  
    27566          NaN           361                 dec  
    27567          NaN           361                 dec  
    27568          NaN           361                 dec  
    27569          NaN           361                 dec  
    27570          NaN           361                 dec  

    [21831 rows x 64 columns]

    #function for the 20% small fruits, 20% big and 80% average
    def AGR_lower_average_upper(df_per_block):
        lower_10th= []
        upper_lower_th= []
        upper_10th= []
        aug_group_df= df_per_block[df_per_block['date_of_year_group']=='aug']
        lower_range= aug_group_df['fruit_diameter'].quantile(0.2)
        upper_range= aug_group_df['fruit_diameter'].quantile(0.8)
        upper_lower= aug_group_df[(aug_group_df['fruit_diameter']>lower_range) & (aug_group_df['fruit_diameter']<upper_range)]
        aug_group_df['fruit_diameter_group'] = pd.cut(aug_group_df['fruit_diameter'], bins=[-float('inf'), lower_range, upper_range, float('inf')], labels=['lower', 'average', 'higher'])
        low_aug_grouped_df = aug_group_df[aug_group_df['fruit_diameter_group']=='lower']
        merged_df_lower = pd.merge(low_aug_grouped_df, df_per_block, on=['cultivar', 'variety', 'block', 'tree_number', 'fruit_number'], how='inner')
        result_df_lower = merged_df_lower[merged_df_lower['date_of_year_group_y'] == 'dec'].drop_duplicates(subset=['cultivar', 'variety', 'block', 'tree_number', 'fruit_number'], keep='first')
        lower_10th= result_df_lower['absolut_fruit_growth_rate_x']
        av_aug_grouped_df = aug_group_df[aug_group_df['fruit_diameter_group']=='average']
        merged_df_av = pd.merge(av_aug_grouped_df, df_per_block, on=['cultivar', 'variety', 'block', 'tree_number', 'fruit_number'], how='inner')
        result_df_av = merged_df_av[merged_df_av['date_of_year_group_y'] == 'dec'].drop_duplicates(subset=['cultivar', 'variety', 'block', 'tree_number', 'fruit_number'], keep='first')
        upper_lower_th= result_df_av['absolut_fruit_growth_rate_x']
        high_aug_grouped_df = aug_group_df[aug_group_df['fruit_diameter_group']=='higher']
        merged_df_higher = pd.merge(high_aug_grouped_df, df_per_block, on=['cultivar', 'variety', 'block', 'tree_number', 'fruit_number'], how='inner')
        result_df_higher = merged_df_higher[merged_df_higher['date_of_year_group_y'] == 'dec'].drop_duplicates(subset=['cultivar', 'variety', 'block', 'tree_number', 'fruit_number'], keep='first')
        upper_10th= result_df_higher['absolut_fruit_growth_rate_x']
        AGR_df=pd.DataFrame({'lower_10th':lower_10th, '10%-90% of data':upper_lower_th, 'upper_10th':upper_10th})
        return AGR_df

    rgr_thresholds= AGR_lower_average_upper(df)
    rgr_thresholds

    /var/folders/dt/92d_4ycx4kl7ds25s_xk72n80000gn/T/ipykernel_27820/947321136.py:10: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead

    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      aug_group_df['fruit_diameter_group'] = pd.cut(aug_group_df['fruit_diameter'], bins=[-float('inf'), lower_range, upper_range, float('inf')], labels=['lower', 'average', 'higher'])

            lower_10th  10%-90% of data  upper_10th
    8           0.1750         0.287500     0.40000
    22          0.1625         0.281250     0.41250
    36          0.1625         0.393750     0.41875
    50          0.2500         0.375000         NaN
    64          0.2375         0.356250     0.50625
    ...            ...              ...         ...
    189615         NaN         0.339767         NaN
    189622         NaN         0.380000         NaN
    189629         NaN              NaN         NaN
    189636         NaN         0.309070         NaN
    189643         NaN         0.254884         NaN

    [1407 rows x 3 columns]

    rgr_thresholds.boxplot()
    plt.xlabel('AGR thresholds')
    plt.ylabel('AGR at the end of the season')
    plt.title('or lul AGR of small,av,big fruits at the end of the season')
    plt.show()

[]

    #anova between the AGR ranges
    from scipy.stats import f_oneway
    cols = ['lower_10th', '10%-90% of data', 'upper_10th']
    rgr_thresholds = rgr_thresholds[cols].dropna()
    fvalue, pvalue = f_oneway(rgr_thresholds['lower_10th'],rgr_thresholds['10%-90% of data'],rgr_thresholds['upper_10th'])
    print('F-value:', fvalue)
    print('P-value:', pvalue)

    F-value: 35.539865102732904
    P-value: 3.011023775141058e-09

    #HSD test
    import statsmodels.stats.multicomp as mc
    rgr_var = [rgr_thresholds['lower_10th'], rgr_thresholds['10%-90% of data'], rgr_thresholds['upper_10th']]
    cols = ['lower_10th', '10%-90% of data', 'upper_10th']
    tukey = mc.MultiComparison(np.hstack(rgr_var), np.hstack([[i] * len(d) for i, d in enumerate(rgr_var)]))
    result = tukey.tukeyhsd()
    print(result)
    #same trend, fruits that were small/av/big at the beginning of the season will be samll/av/big at the end of the season

    Multiple Comparison of Means - Tukey HSD, FWER=0.05
    ==================================================
    group1 group2 meandiff p-adj  lower  upper  reject
    --------------------------------------------------
         0      1   0.1375 0.0001 0.0688 0.2062   True
         0      2   0.2358    0.0 0.1672 0.3045   True
         1      2   0.0983 0.0035 0.0297  0.167   True
    --------------------------------------------------

    #let's find the treshold for the % of small fruits in which there is no difference in the AGR from the av size
    #in this case, we can tell that if customer block has a high amount of small fruits, we can't use the same AGR to predict the fruits at picking
